"use strict";(globalThis["webpackChunknonebot_plugin_gocqhttp_frontend"]=globalThis["webpackChunknonebot_plugin_gocqhttp_frontend"]||[]).push([[144],{86858:(e,t,i)=>{i.r(t);var n=i(48077),o=i(99868),r=i(25206);class s extends n.R6{constructor(){super({id:"editor.action.fontZoomIn",label:r.NC("EditorFontZoomIn.label","Editor Font Zoom In"),alias:"Editor Font Zoom In",precondition:void 0})}run(e,t){o.C.setZoomLevel(o.C.getZoomLevel()+1)}}class a extends n.R6{constructor(){super({id:"editor.action.fontZoomOut",label:r.NC("EditorFontZoomOut.label","Editor Font Zoom Out"),alias:"Editor Font Zoom Out",precondition:void 0})}run(e,t){o.C.setZoomLevel(o.C.getZoomLevel()-1)}}class d extends n.R6{constructor(){super({id:"editor.action.fontZoomReset",label:r.NC("EditorFontZoomReset.label","Editor Font Zoom Reset"),alias:"Editor Font Zoom Reset",precondition:void 0})}run(e,t){o.C.setZoomLevel(0)}}(0,n.Qr)(s),(0,n.Qr)(a),(0,n.Qr)(d)},60219:(e,t,i)=>{i.d(t,{Qq:()=>x,Qs:()=>O,Zg:()=>D,x$:()=>R,xC:()=>N});var n=i(69332),o=i(21921),r=i(55191),s=i(98642),a=i(39595),d=i(33010),l=i(55455),c=i(95896),h=i(39363),u=i(35491),g=i(89999),p=i(33162),_=i(54644),f=i(52473),m=i(15498),v=i(20606),C=i(25206),y=i(46871),b=i(94022),w=i(21881),S=i(16458),k=i(23034),M=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};function D(e){if(e=e.filter((e=>e.range)),!e.length)return;let{range:t}=e[0];for(let n=1;n<e.length;n++)t=p.e.plusRange(t,e[n].range);const{startLineNumber:i,endLineNumber:o}=t;i===o?1===e.length?(0,n.Z9)(C.NC("hint11","Made 1 formatting edit on line {0}",i)):(0,n.Z9)(C.NC("hintn1","Made {0} formatting edits on line {1}",e.length,i)):1===e.length?(0,n.Z9)(C.NC("hint1n","Made 1 formatting edit between lines {0} and {1}",i,o)):(0,n.Z9)(C.NC("hintnn","Made {0} formatting edits between lines {1} and {2}",e.length,i,o))}function P(e,t,i){const n=[],o=new Set,r=e.ordered(i);for(const a of r)n.push(a),a.extensionId&&o.add(b.k.toKey(a.extensionId));const s=t.ordered(i);for(const a of s){if(a.extensionId){if(o.has(b.k.toKey(a.extensionId)))continue;o.add(b.k.toKey(a.extensionId))}n.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(e,t,i){return a.provideDocumentRangeFormattingEdits(e,e.getFullModelRange(),t,i)}})}return n}class N{static setFormatterSelector(e){const t=N._selectors.unshift(e);return{dispose:t}}static select(e,t,i){return M(this,void 0,void 0,(function*(){if(0===e.length)return;const n=a.$.first(N._selectors);return n?yield n(e,t,i):void 0}))}}function R(e,t,i,n,o,r){return M(this,void 0,void 0,(function*(){const s=e.get(w.TG),{documentRangeFormattingEditProvider:a}=e.get(S.p),d=(0,u.CL)(t)?t.getModel():t,l=a.ordered(d),c=yield N.select(l,d,n);c&&(o.report(c),yield s.invokeFunction(I,c,t,i,r))}))}function I(e,t,i,n,r){return M(this,void 0,void 0,(function*(){const s=e.get(f.p),a=e.get(k.VZ);let d,l;(0,u.CL)(i)?(d=i.getModel(),l=new h.Dl(i,5,void 0,r)):(d=i,l=new h.YQ(i,r));const c=[];let g=0;for(const e of(0,o._2)(n).sort(p.e.compareRangesUsingStarts))g>0&&p.e.areIntersectingOrTouching(c[g-1],e)?c[g-1]=p.e.fromPositions(c[g-1].getStartPosition(),e.getEndPosition()):g=c.push(e);const m=e=>M(this,void 0,void 0,(function*(){var i,n;a.trace("[format][provideDocumentRangeFormattingEdits] (request)",null===(i=t.extensionId)||void 0===i?void 0:i.value,e);const o=(yield t.provideDocumentRangeFormattingEdits(d,e,d.getFormattingOptions(),l.token))||[];return a.trace("[format][provideDocumentRangeFormattingEdits] (response)",null===(n=t.extensionId)||void 0===n?void 0:n.value,o),o})),C=(e,t)=>{if(!e.length||!t.length)return!1;const i=e.reduce(((e,t)=>p.e.plusRange(e,t.range)),e[0].range);if(!t.some((e=>p.e.intersectRanges(i,e.range))))return!1;for(const n of e)for(const e of t)if(p.e.intersectRanges(n.range,e.range))return!0;return!1},y=[],b=[];try{for(const e of c){if(l.token.isCancellationRequested)return!0;b.push(yield m(e))}for(let e=0;e<c.length;++e)for(let t=e+1;t<c.length;++t){if(l.token.isCancellationRequested)return!0;if(C(b[e],b[t])){const i=p.e.plusRange(c[e],c[t]),n=yield m(i);c.splice(t,1),c.splice(e,1),c.push(i),b.splice(t,1),b.splice(e,1),b.push(n),e=0,t=0}}for(const e of b){if(l.token.isCancellationRequested)return!0;const t=yield s.computeMoreMinimalEdits(d.uri,e);t&&y.push(...t)}}finally{l.dispose()}if(0===y.length)return!1;if((0,u.CL)(i))v.V.execute(i,y,!0),D(y),i.revealPositionInCenterIfOutsideViewport(i.getPosition(),1);else{const[{range:e}]=y,t=new _.Y(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);d.pushEditOperations([t],y.map((e=>({text:e.text,range:p.e.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:i}of e)if(p.e.areIntersectingOrTouching(i,t))return[new _.Y(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)];return null}))}return!0}))}function x(e,t,i,n,o){return M(this,void 0,void 0,(function*(){const r=e.get(w.TG),s=e.get(S.p),a=(0,u.CL)(t)?t.getModel():t,d=P(s.documentFormattingEditProvider,s.documentRangeFormattingEditProvider,a),l=yield N.select(d,a,i);l&&(n.report(l),yield r.invokeFunction(L,l,t,i,o))}))}function L(e,t,i,n,o){return M(this,void 0,void 0,(function*(){const r=e.get(f.p);let s,a,d;(0,u.CL)(i)?(s=i.getModel(),a=new h.Dl(i,5,void 0,o)):(s=i,a=new h.YQ(i,o));try{const e=yield t.provideDocumentFormattingEdits(s,s.getFormattingOptions(),a.token);if(d=yield r.computeMoreMinimalEdits(s.uri,e),a.token.isCancellationRequested)return!0}finally{a.dispose()}if(!d||0===d.length)return!1;if((0,u.CL)(i))v.V.execute(i,d,2!==n),2!==n&&(D(d),i.revealPositionInCenterIfOutsideViewport(i.getPosition(),1));else{const[{range:e}]=d,t=new _.Y(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);s.pushEditOperations([t],d.map((e=>({text:e.text,range:p.e.lift(e.range),forceMoveMarkers:!0}))),(e=>{for(const{range:i}of e)if(p.e.areIntersectingOrTouching(i,t))return[new _.Y(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)];return null}))}return!0}))}function T(e,t,i,n,r,a){return M(this,void 0,void 0,(function*(){const d=t.documentRangeFormattingEditProvider.ordered(i);for(const t of d){const d=yield Promise.resolve(t.provideDocumentRangeFormattingEdits(i,n,r,a)).catch(s.Cp);if((0,o.Of)(d))return yield e.computeMoreMinimalEdits(i.uri,d)}}))}function E(e,t,i,n,r){return M(this,void 0,void 0,(function*(){const a=P(t.documentFormattingEditProvider,t.documentRangeFormattingEditProvider,i);for(const t of a){const a=yield Promise.resolve(t.provideDocumentFormattingEdits(i,n,r)).catch(s.Cp);if((0,o.Of)(a))return yield e.computeMoreMinimalEdits(i.uri,a)}}))}function O(e,t,i,n,o,r,a){const d=t.onTypeFormattingEditProvider.ordered(i);return 0===d.length||d[0].autoFormatTriggerCharacters.indexOf(o)<0?Promise.resolve(void 0):Promise.resolve(d[0].provideOnTypeFormattingEdits(i,n,o,r,a)).catch(s.Cp).then((t=>e.computeMoreMinimalEdits(i.uri,t)))}N._selectors=new d.S,y.P.registerCommand("_executeFormatRangeProvider",(function(e,...t){return M(this,void 0,void 0,(function*(){const[i,n,o]=t;(0,l.p_)(c.o.isUri(i)),(0,l.p_)(p.e.isIRange(n));const s=e.get(m.S),a=e.get(f.p),d=e.get(S.p),h=yield s.createModelReference(i);try{return T(a,d,h.object.textEditorModel,p.e.lift(n),o,r.T.None)}finally{h.dispose()}}))})),y.P.registerCommand("_executeFormatDocumentProvider",(function(e,...t){return M(this,void 0,void 0,(function*(){const[i,n]=t;(0,l.p_)(c.o.isUri(i));const o=e.get(m.S),s=e.get(f.p),a=e.get(S.p),d=yield o.createModelReference(i);try{return E(s,a,d.object.textEditorModel,n,r.T.None)}finally{d.dispose()}}))})),y.P.registerCommand("_executeFormatOnTypeProvider",(function(e,...t){return M(this,void 0,void 0,(function*(){const[i,n,o,s]=t;(0,l.p_)(c.o.isUri(i)),(0,l.p_)(g.L.isIPosition(n)),(0,l.p_)("string"===typeof o);const a=e.get(m.S),d=e.get(f.p),h=e.get(S.p),u=yield a.createModelReference(i);try{return O(d,h,u.object.textEditorModel,g.L.lift(n),o,s,r.T.None)}finally{u.dispose()}}))}))},64457:(e,t,i)=>{i.r(t);var n=i(21921),o=i(55191),r=i(98642),s=i(56082),a=i(70959),d=i(48077),l=i(35195),c=i(51099),h=i(33162),u=i(44950),g=i(52473),p=i(16458),_=i(60219),f=i(20606),m=i(25206),v=i(46871),C=i(66538),y=i(21881),b=i(34679),w=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},S=function(e,t){return function(i,n){t(i,n,e)}},k=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};let M=class{constructor(e,t,i){this._editor=e,this._languageFeaturesService=t,this._workerService=i,this._disposables=new a.SL,this._sessionDisposables=new a.SL,this._disposables.add(t.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(53)&&this._update()}))),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(53))return;if(!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;const i=new c.q;for(const n of t.autoFormatTriggerCharacters)i.add(n.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType((e=>{const t=e.charCodeAt(e.length-1);i.has(t)&&this._trigger(String.fromCharCode(t))})))}_trigger(e){if(!this._editor.hasModel())return;if(this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const t=this._editor.getModel(),i=this._editor.getPosition(),r=new o.A,s=this._editor.onDidChangeModelContent((e=>{if(e.isFlush)return r.cancel(),void s.dispose();for(let t=0,n=e.changes.length;t<n;t++){const n=e.changes[t];if(n.range.endLineNumber<=i.lineNumber)return r.cancel(),void s.dispose()}}));(0,_.Qs)(this._workerService,this._languageFeaturesService,t,i,e,t.getFormattingOptions(),r.token).then((e=>{r.token.isCancellationRequested||(0,n.Of)(e)&&(f.V.execute(this._editor,e,!0),(0,_.Zg)(e))})).finally((()=>{s.dispose()}))}};M.ID="editor.contrib.autoFormat",M=w([S(1,p.p),S(2,g.p)],M);let D=class{constructor(e,t,i){this.editor=e,this._languageFeaturesService=t,this._instantiationService=i,this._callOnDispose=new a.SL,this._callOnModel=new a.SL,this._callOnDispose.add(e.onDidChangeConfiguration((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModel((()=>this._update()))),this._callOnDispose.add(e.onDidChangeModelLanguage((()=>this._update()))),this._callOnDispose.add(t.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(52)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste((({range:e})=>this._trigger(e))))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(_.x$,this.editor,e,2,b.Ex.None,o.T.None).catch(r.dL))}};D.ID="editor.contrib.formatOnPaste",D=w([S(1,p.p),S(2,y.TG)],D);class P extends d.R6{constructor(){super({id:"editor.action.formatDocument",label:m.NC("formatDocument.label","Format Document"),alias:"Format Document",precondition:C.Ao.and(u.u.notInCompositeEditor,u.u.writable,u.u.hasDocumentFormattingProvider),kbOpts:{kbExpr:u.u.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}run(e,t){return k(this,void 0,void 0,(function*(){if(t.hasModel()){const i=e.get(y.TG),n=e.get(b.ek);yield n.showWhile(i.invokeFunction(_.Qq,t,1,b.Ex.None,o.T.None),250)}}))}}class N extends d.R6{constructor(){super({id:"editor.action.formatSelection",label:m.NC("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:C.Ao.and(u.u.writable,u.u.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:u.u.editorTextFocus,primary:(0,s.gx)(2089,2084),weight:100},contextMenuOpts:{when:u.u.hasNonEmptySelection,group:"1_modification",order:1.31}})}run(e,t){return k(this,void 0,void 0,(function*(){if(!t.hasModel())return;const i=e.get(y.TG),n=t.getModel(),r=t.getSelections().map((e=>e.isEmpty()?new h.e(e.startLineNumber,1,e.startLineNumber,n.getLineMaxColumn(e.startLineNumber)):e)),s=e.get(b.ek);yield s.showWhile(i.invokeFunction(_.x$,t,r,1,b.Ex.None,o.T.None),250)}))}}(0,d._K)(M.ID,M,2),(0,d._K)(D.ID,D,2),(0,d.Qr)(P),(0,d.Qr)(N),v.P.registerCommand("editor.action.format",(e=>k(void 0,void 0,void 0,(function*(){const t=e.get(l.$).getFocusedCodeEditor();if(!t||!t.hasModel())return;const i=e.get(v.H);t.getSelection().isEmpty()?yield i.executeCommand("editor.action.formatDocument"):yield i.executeCommand("editor.action.formatSelection")}))))},20606:(e,t,i)=>{i.d(t,{V:()=>s});var n=i(90970),o=i(33162),r=i(95402);class s{static _handleEolEdits(e,t){let i;const n=[];for(const o of t)"number"===typeof o.eol&&(i=o.eol),o.range&&"string"===typeof o.text&&n.push(o);return"number"===typeof i&&e.hasModel()&&e.getModel().pushEOL(i),n}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const i=e.getModel(),n=i.validateRange(t.range),o=i.getFullModelRange();return o.equalsRange(n)}static execute(e,t,i){i&&e.pushUndoStop();const a=r.Z.capture(e),d=s._handleEolEdits(e,t);1===d.length&&s._isFullModelReplaceEdit(e,d[0])?e.executeEdits("formatEditsCommand",d.map((e=>n.h.replace(o.e.lift(e.range),e.text)))):e.executeEdits("formatEditsCommand",d.map((e=>n.h.replaceMove(o.e.lift(e.range),e.text)))),i&&e.pushUndoStop(),a.restoreRelativeVerticalPositionOfCursor(e)}}},68703:(e,t,i)=>{i.r(t),i.d(t,{DefinitionAction:()=>$e,SymbolNavigationAction:()=>ze,SymbolNavigationAnchor:()=>Ge});var n=i(90882),o=i(69332),r=i(85398),s=i(56082),a=i(47606),d=i(55455),l=i(95896),c=i(39363),h=i(35491),u=i(48077),g=i(35195),p=i(24788),_=i(89999),f=i(33162),m=i(44950),v=i(67026),C=i(98642),y=i(70959),b=i(78097),w=i(25206),S=i(46871),k=i(47596),M=i(66538),D=i(21881),P=i(37395),N=i(15142),R=i(18736),I=i(51906),x=i(7316),L=i(2548),T=i(26156),E=i(60204),O=i(11271),A=i(50200),F=i(21230),W=i(16375),H=i(97297),K=i(32484),V=i(61141),U=i(15498),B=i(86829),G=i(32907),z=i(10791),$=i(70546),j=i(15285),Z=i(51549),Q=i(22454),q=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},X=function(e,t){return function(i,n){t(i,n,e)}};let J=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof x.oQ||e instanceof x.F2}getChildren(e){if(e instanceof x.oQ)return e.groups;if(e instanceof x.F2)return e.resolve(this._resolverService).then((e=>e.children));throw new Error("bad tree")}};J=q([X(0,U.S)],J);class Y{getHeight(){return 23}getTemplateId(e){return e instanceof x.F2?ne.id:re.id}}let ee=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var t;if(e instanceof x.WX){const i=null===(t=e.parent.getPreview(e))||void 0===t?void 0:t.preview(e.range);if(i)return i.value}return(0,F.EZ)(e.uri)}};ee=q([X(0,j.d)],ee);class te{getId(e){return e instanceof x.WX?e.id:e.uri}}let ie=class extends y.JT{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new z.g(i,{supportHighlights:!0})),this.badge=new B.Z(L.R3(i,L.$(".count")),{},Q.ku),e.appendChild(i)}set(e,t){const i=(0,F.XX)(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const n=e.children.length;this.badge.setCount(n),n>1?this.badge.setTitleFormat((0,w.NC)("referencesCount","{0} references",n)):this.badge.setTitleFormat((0,w.NC)("referenceCount","{0} reference",n))}};ie=q([X(1,Z.e)],ie);let ne=class e{constructor(t){this._instantiationService=t,this.templateId=e.id}renderTemplate(e){return this._instantiationService.createInstance(ie,e)}renderElement(e,t,i){i.set(e.element,(0,$.mB)(e.filterData))}disposeTemplate(e){e.dispose()}};ne.id="FileReferencesRenderer",ne=q([X(0,D.TG)],ne);class oe{constructor(e){this.label=new G.q(e)}set(e,t){var i;const n=null===(i=e.parent.getPreview(e))||void 0===i?void 0:i.preview(e.range);if(n&&n.value){const{value:e,highlight:i}=n;t&&!$.CL.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(e,(0,$.mB)(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(e,[i]))}else this.label.set(`${(0,F.EZ)(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`)}}class re{constructor(){this.templateId=re.id}renderTemplate(e){return new oe(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(){}}re.id="OneReferenceRenderer";class se{getWidgetAriaLabel(){return(0,w.NC)("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var ae=i(32656),de=i(70813),le=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},ce=function(e,t){return function(i,n){t(i,n,e)}},he=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};class ue{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new y.SL,this._callOnModelChange=new y.SL,this._callOnDispose.add(this._editor.onDidChangeModel((()=>this._onModelChanged()))),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e)for(const t of this._model.references)if(t.uri.toString()===e.uri.toString())return void this._addDecorations(t.parent)}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations((()=>this._onDecorationChanged())));const t=[],i=[];for(let n=0,o=e.children.length;n<o;n++){const o=e.children[n];this._decorationIgnoreSet.has(o.id)||o.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:o.range,options:ue.DecorationOptions}),i.push(n))}this._editor.changeDecorations((n=>{const o=n.deltaDecorations([],t);for(let t=0;t<o.length;t++)this._decorations.set(o[t],e.children[i[t]])}))}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,n]of this._decorations){const o=t.getDecorationRange(i);if(!o)continue;let r=!1;if(!f.e.equalsRange(o,n.range)){if(f.e.spansMultipleLines(o))r=!0;else{const e=n.range.endColumn-n.range.startColumn,t=o.endColumn-o.startColumn;e!==t&&(r=!0)}r?(this._decorationIgnoreSet.add(n.id),e.push(i)):n.range=o}}for(let t=0,i=e.length;t<i;t++)this._decorations.delete(e[t]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}}ue.DecorationOptions=W.qx.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});class ge{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const n=JSON.parse(e);t=n.ratio,i=n.heightInLines}catch(Re){}return{ratio:t||.7,heightInLines:i||18}}}class pe extends N.ls{}let _e=class extends b.vk{constructor(e,t,i,n,o,r,s,a,d,l,c,h){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=o,this._instantiationService=r,this._peekViewService=s,this._uriLabel=a,this._undoRedoService=d,this._keybindingService=l,this._languageService=c,this._languageConfigurationService=h,this._disposeOnNewModel=new y.SL,this._callOnDispose=new y.SL,this._onDidSelectReference=new O.Q5,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new L.Ro(0,0),this._applyTheme(n.getColorTheme()),this._callOnDispose.add(n.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),(0,y.B9)(this._preview),(0,y.B9)(this._previewNotAvailableMessage),(0,y.B9)(this._tree),(0,y.B9)(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(b.SC)||E.Il.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(b.KY)||E.Il.transparent,primaryHeadingColor:e.getColor(b.IH),secondaryHeadingColor:e.getColor(b.R7)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=L.R3(e,L.$("div.messages")),L.Cp(this._messageContainer),this._splitView=new T.z(e,{orientation:1}),this._previewContainer=L.R3(e,L.$("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(p.H,this._previewContainer,t,this.editor),L.Cp(this._previewContainer),this._previewNotAvailableMessage=new W.yO(w.NC("missingPreviewMessage","no preview available"),K.bd,W.yO.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=L.R3(e,L.$("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new se,keyboardNavigationLabelProvider:this._instantiationService.createInstance(ee),identityProvider:new te,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:b.M8}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(L.mu(this._treeContainer,"keydown",(e=>{e.equals(9)&&(this._keybindingService.dispatchEvent(e,e.target),e.stopPropagation())}),!0)),this._tree=this._instantiationService.createInstance(pe,"ReferencesWidget",this._treeContainer,new Y,[this._instantiationService.createInstance(ne),this._instantiationService.createInstance(re)],this._instantiationService.createInstance(J),i),this._splitView.addView({onDidChange:O.ju.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._preview.layout({height:this._dim.height,width:e})}},T.M.Distribute),this._splitView.addView({onDidChange:O.ju.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${e}px`,this._tree.layout(this._dim.height,e)}},T.M.Distribute),this._disposables.add(this._splitView.onDidSashChange((()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)}),void 0));const n=(e,t)=>{e instanceof x.WX&&("show"===t&&this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:t,source:"tree"}))};this._tree.onDidOpen((e=>{e.sideBySide?n(e.element,"side"):e.editorOptions.pinned?n(e.element,"goto"):n(e.element,"show")})),L.Cp(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new L.Ro(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then((()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))}))}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=w.NC("noResults","No results"),L.$Z(this._messageContainer),Promise.resolve(void 0)):(L.Cp(this._messageContainer),this._decorationsManager=new ue(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange((e=>this._tree.rerender(e)))),this._disposeOnNewModel.add(this._preview.onMouseDown((e=>{const{event:t,target:i}=e;if(2!==t.detail)return;const n=this._getFocusedReference();n&&this._onDidSelectReference.fire({element:{uri:n.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})}))),this.container.classList.add("results-loaded"),L.$Z(this._treeContainer),L.$Z(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(1===this._model.groups.length?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();return e instanceof x.WX?e:e instanceof x.F2&&e.children.length>0?e.children[0]:void 0}revealReference(e){return he(this,void 0,void 0,(function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}))}_revealReference(e,t){return he(this,void 0,void 0,(function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==A.lg.inMemory?this.setTitle((0,F.Hx)(e.uri),this._uriLabel.getUriLabel((0,F.XX)(e.uri))):this.setTitle(w.NC("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent||(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent)),this._tree.reveal(e);const n=yield i;if(!this._model)return void n.dispose();(0,y.B9)(this._previewModelReference);const o=n.object;if(o){const t=this._preview.getModel()===o.textEditorModel?0:1,i=f.e.lift(e.range).collapseToStart();this._previewModelReference=n,this._preview.setModel(o.textEditorModel),this._preview.setSelection(i),this._preview.revealRangeInCenter(i,t)}else this._preview.setModel(this._previewNotAvailableMessage),n.dispose()}))}};_e=le([ce(3,ae.XE),ce(4,U.S),ce(5,D.TG),ce(6,b.Fw),ce(7,Z.e),ce(8,de.tJ),ce(9,j.d),ce(10,V.O),ce(11,H.c_)],_e);var fe=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},me=function(e,t){return function(i,n){t(i,n,e)}},ve=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};const Ce=new M.uy("referenceSearchVisible",!1,w.NC("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));let ye=class e{static get(t){return t.getContribution(e.ID)}constructor(e,t,i,n,o,r,s,a){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=n,this._notificationService=o,this._instantiationService=r,this._storageService=s,this._configurationService=a,this._disposables=new y.SL,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=Ce.bindTo(i)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),null===(e=this._widget)||void 0===e||e.dispose(),null===(t=this._model)||void 0===t||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let n;if(this._widget&&(n=this._widget.position),this.closeWidget(),n&&e.containsPosition(n))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage((()=>{this.closeWidget()}))),this._disposables.add(this._editor.onDidChangeModel((()=>{this._ignoreModelChangeEvent||this.closeWidget()})));const o="peekViewLayout",r=ge.fromJSON(this._storageService.get(o,0,"{}"));this._widget=this._instantiationService.createInstance(_e,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(w.NC("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose((()=>{t.cancel(),this._widget&&(this._storageService.store(o,JSON.stringify(this._widget.layoutData),0,1),this._widget=void 0),this.closeWidget()}))),this._disposables.add(this._widget.onDidSelectReference((e=>{const{element:t,kind:n}=e;if(t)switch(n){case"open":"editor"===e.source&&this._configurationService.getValue("editor.stablePeek")||this.openReference(t,!1,!1);break;case"side":this.openReference(t,!0,!1);break;case"goto":i?this._gotoReference(t,!0):this.openReference(t,!1,!0);break}})));const s=++this._requestIdPool;t.then((t=>{var i;if(s===this._requestIdPool&&this._widget)return null===(i=this._model)||void 0===i||i.dispose(),this._model=t,this._widget.setModel(this._model).then((()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(w.NC("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const t=this._editor.getModel().uri,i=new _.L(e.startLineNumber,e.startColumn),n=this._model.nearestReference(t,i);if(n)return this._widget.setSelection(n).then((()=>{this._widget&&"editor"===this._editor.getOption(82)&&this._widget.focusOnPreviewEditor()}))}}));t.dispose()}),(e=>{this._notificationService.error(e)}))}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return ve(this,void 0,void 0,(function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const n=this._model.nextOrPreviousReference(i,e),o=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(n),yield this._gotoReference(n,!1),o?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()}))}revealReference(e){return ve(this,void 0,void 0,(function*(){this._editor.hasModel()&&this._model&&this._widget&&(yield this._widget.revealReference(e))}))}closeWidget(e=!0){var t,i;null===(t=this._widget)||void 0===t||t.dispose(),null===(i=this._model)||void 0===i||i.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(t,i){var n;null===(n=this._widget)||void 0===n||n.hide(),this._ignoreModelChangeEvent=!0;const o=f.e.lift(t.range).collapseToStart();return this._editorService.openCodeEditor({resource:t.uri,options:{selection:o,selectionSource:"code.jump",pinned:i}},this._editor).then((t=>{var i;if(this._ignoreModelChangeEvent=!1,t&&this._widget)if(this._editor===t)this._widget.show(o),this._widget.focusOnReferenceTree();else{const n=e.get(t),s=this._model.clone();this.closeWidget(),t.focus(),null===n||void 0===n||n.toggleWidget(o,(0,r.PG)((e=>Promise.resolve(s))),null!==(i=this._peekMode)&&void 0!==i&&i)}else this.closeWidget()}),(e=>{this._ignoreModelChangeEvent=!1,(0,C.dL)(e)}))}openReference(e,t,i){t||this.closeWidget();const{uri:n,range:o}=e;this._editorService.openCodeEditor({resource:n,options:{selection:o,selectionSource:"code.jump",pinned:i}},this._editor,t)}};function be(e,t){const i=(0,b.rc)(e);if(!i)return;const n=ye.get(i);n&&t(n)}ye.ID="editor.contrib.referencesController",ye=fe([me(2,M.i6),me(3,g.$),me(4,R.lT),me(5,D.TG),me(6,I.Uy),me(7,k.Ui)],ye),P.W.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:(0,s.gx)(2089,60),when:M.Ao.or(Ce,b.Jy.inPeekEditor),handler(e){be(e,(e=>{e.changeFocusBetweenPreviewAndReferences()}))}}),P.W.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:M.Ao.or(Ce,b.Jy.inPeekEditor),handler(e){be(e,(e=>{e.goToNextOrPreviousReference(!0)}))}}),P.W.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:M.Ao.or(Ce,b.Jy.inPeekEditor),handler(e){be(e,(e=>{e.goToNextOrPreviousReference(!1)}))}}),S.P.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference"),S.P.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference"),S.P.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch"),S.P.registerCommand("closeReferenceSearch",(e=>be(e,(e=>e.closeWidget())))),P.W.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:M.Ao.and(b.Jy.inPeekEditor,M.Ao.not("config.editor.stablePeek"))}),P.W.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:M.Ao.and(Ce,M.Ao.not("config.editor.stablePeek"))}),P.W.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:M.Ao.and(Ce,N.CQ,N.PS.negate(),N.uJ.negate()),handler(e){var t;const i=e.get(N.Lw),n=null===(t=i.lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof x.WX&&be(e,(e=>e.revealReference(n[0])))}}),P.W.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:M.Ao.and(Ce,N.CQ,N.PS.negate(),N.uJ.negate()),handler(e){var t;const i=e.get(N.Lw),n=null===(t=i.lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof x.WX&&be(e,(e=>e.openReference(n[0],!0,!0)))}}),S.P.registerCommand("openReference",(e=>{var t;const i=e.get(N.Lw),n=null===(t=i.lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof x.WX&&be(e,(e=>e.openReference(n[0],!1,!0)))}));var we=i(39326),Se=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},ke=function(e,t){return function(i,n){t(i,n,e)}};const Me=new M.uy("hasSymbols",!1,(0,w.NC)("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),De=(0,D.yh)("ISymbolNavigationService");let Pe=class{constructor(e,t,i,n){this._editorService=t,this._notificationService=i,this._keybindingService=n,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=Me.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),null===(e=this._currentState)||void 0===e||e.dispose(),null===(t=this._currentMessage)||void 0===t||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1)return void this.reset();this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new Ne(this._editorService),n=i.onDidChange((e=>{if(this._ignoreEditorChange)return;const i=this._editorService.getActiveCodeEditor();if(!i)return;const n=i.getModel(),o=i.getPosition();if(!n||!o)return;let r=!1,s=!1;for(const a of t.references)if((0,F.Xy)(a.uri,n.uri))r=!0,s=s||f.e.containsPosition(a.range,o);else if(r)break;r&&s||this.reset()}));this._currentState=(0,y.F8)(i,n)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:f.e.collapseToStart(t.range),selectionRevealType:3}},e).finally((()=>{this._ignoreEditorChange=!1}))}_showMessage(){var e;null===(e=this._currentMessage)||void 0===e||e.dispose();const t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),i=t?(0,w.NC)("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):(0,w.NC)("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(i)}};Pe=Se([ke(0,M.i6),ke(1,g.$),ke(2,R.lT),ke(3,j.d)],Pe),(0,we.z)(De,Pe,1),(0,u.fK)(new class extends u._l{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:Me,kbOpts:{weight:100,primary:70}})}runEditorCommand(e,t){return e.get(De).revealNext(t)}}),P.W.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:Me,primary:9,handler(e){e.get(De).reset()}});let Ne=class{constructor(e){this._listener=new Map,this._disposables=new y.SL,this._onDidChange=new O.Q5,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),(0,y.B9)(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,(0,y.F8)(e.onDidChangeCursorPosition((t=>this._onDidChange.fire({editor:e}))),e.onDidChangeModelContent((t=>this._onDidChange.fire({editor:e})))))}_onDidRemoveEditor(e){var t;null===(t=this._listener.get(e))||void 0===t||t.dispose(),this._listener.delete(e)}};Ne=Se([ke(0,g.$)],Ne);var Re,Ie,xe,Le,Te,Ee,Oe,Ae,Fe=i(11898),We=i(82693),He=i(34679),Ke=i(18815),Ve=i(16458),Ue=i(39595),Be=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};We.BH.appendMenuItem(We.eH.EditorContext,{submenu:We.eH.EditorContextPeek,title:w.NC("peek.submenu","Peek"),group:"navigation",order:100});class Ge{static is(e){return!(!e||"object"!==typeof e)&&(e instanceof Ge||!(!_.L.isIPosition(e.position)||!e.model))}constructor(e,t){this.model=e,this.position=t}}class ze extends u.x1{static all(){return ze._allSymbolNavigationCommands.values()}static _patchConfig(e){const t=Object.assign(Object.assign({},e),{f1:!0});if(t.menu)for(const i of Ue.$.wrap(t.menu))i.id!==We.eH.EditorContext&&i.id!==We.eH.EditorContextPeek||(i.when=M.Ao.and(e.precondition,i.when));return t}constructor(e,t){super(ze._patchConfig(t)),this.configuration=e,ze._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,n){if(!t.hasModel())return Promise.resolve(void 0);const s=e.get(R.lT),a=e.get(g.$),d=e.get(He.ek),l=e.get(De),h=e.get(Ve.p),u=e.get(D.TG),p=t.getModel(),_=t.getPosition(),f=Ge.is(i)?i:new Ge(p,_),m=new c.Dl(t,5),v=(0,r.eP)(this._getLocationModel(h,f.model,f.position,m.token),m.token).then((e=>Be(this,void 0,void 0,(function*(){var r;if(!e||m.token.isCancellationRequested)return;let s;if((0,o.Z9)(e.ariaMessage),e.referenceAt(p.uri,_)){const e=this._getAlternativeCommand(t);!ze._activeAlternativeCommands.has(e)&&ze._allSymbolNavigationCommands.has(e)&&(s=ze._allSymbolNavigationCommands.get(e))}const d=e.references.length;if(0===d){if(!this.configuration.muteMessage){const e=p.getWordAtPosition(_);null===(r=Fe.O.get(t))||void 0===r||r.showMessage(this._getNoResultFoundMessage(e),_)}}else{if(1!==d||!s)return this._onResult(a,l,t,e,n);ze._activeAlternativeCommands.add(this.desc.id),u.invokeFunction((e=>s.runEditorCommand(e,t,i,n).finally((()=>{ze._activeAlternativeCommands.delete(this.desc.id)}))))}}))),(e=>{s.error(e)})).finally((()=>{m.dispose()}));return d.showWhile(v,250),v}_onResult(e,t,i,n,o){return Be(this,void 0,void 0,(function*(){const r=this._getGoToPreference(i);if(i instanceof p.H||!(this.configuration.openInPeek||"peek"===r&&n.references.length>1)){const s=n.firstReference(),a=n.references.length>1&&"gotoAndPeek"===r,d=yield this._openReference(i,e,s,this.configuration.openToSide,!a);a&&d?this._openInPeek(d,n,o):n.dispose(),"goto"===r&&t.put(s)}else this._openInPeek(i,n,o)}))}_openReference(e,t,i,n,o){return Be(this,void 0,void 0,(function*(){let r;if((0,v.vx)(i)&&(r=i.targetSelectionRange),r||(r=i.range),!r)return;const s=yield t.openCodeEditor({resource:i.uri,options:{selection:f.e.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},e,n);if(s){if(o){const e=s.getModel(),t=s.createDecorationsCollection([{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout((()=>{s.getModel()===e&&t.clear()}),350)}return s}}))}_openInPeek(e,t,i){const n=ye.get(e);n&&e.hasModel()?n.toggleWidget(null!==i&&void 0!==i?i:e.getSelection(),(0,r.PG)((e=>Promise.resolve(t))),this.configuration.openInPeek):t.dispose()}}ze._allSymbolNavigationCommands=new Map,ze._activeAlternativeCommands=new Set;class $e extends ze{_getLocationModel(e,t,i,n){return Be(this,void 0,void 0,(function*(){return new x.oQ(yield(0,Ke.nD)(e.definitionProvider,t,i,n),w.NC("def.title","Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("noResultWord","No definition found for '{0}'",e.word):w.NC("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(55).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(55).multipleDefinitions}}const je=a.$L&&!(0,n.isStandalone)()?2118:70;(0,We.r1)((Re=class e extends $e{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,title:{value:w.NC("actions.goToDecl.label","Go to Definition"),original:"Go to Definition",mnemonicTitle:w.NC({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:M.Ao.and(m.u.hasDefinitionProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:je,weight:100},menu:[{id:We.eH.EditorContext,group:"navigation",order:1.1},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),S.P.registerCommandAlias("editor.action.goToDeclaration",e.id)}},Re.id="editor.action.revealDefinition",Re)),(0,We.r1)((Ie=class e extends $e{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:e.id,title:{value:w.NC("actions.goToDeclToSide.label","Open Definition to the Side"),original:"Open Definition to the Side"},precondition:M.Ao.and(m.u.hasDefinitionProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:(0,s.gx)(2089,je),weight:100}}),S.P.registerCommandAlias("editor.action.openDeclarationToTheSide",e.id)}},Ie.id="editor.action.revealDefinitionAside",Ie)),(0,We.r1)((xe=class e extends $e{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.id,title:{value:w.NC("actions.previewDecl.label","Peek Definition"),original:"Peek Definition"},precondition:M.Ao.and(m.u.hasDefinitionProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:We.eH.EditorContextPeek,group:"peek",order:2}}),S.P.registerCommandAlias("editor.action.previewDeclaration",e.id)}},xe.id="editor.action.peekDefinition",xe));class Ze extends ze{_getLocationModel(e,t,i,n){return Be(this,void 0,void 0,(function*(){return new x.oQ(yield(0,Ke.zq)(e.declarationProvider,t,i,n),w.NC("decl.title","Declarations"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("decl.noResultWord","No declaration found for '{0}'",e.word):w.NC("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(55).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(55).multipleDeclarations}}(0,We.r1)((Le=class e extends Ze{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,title:{value:w.NC("actions.goToDeclaration.label","Go to Declaration"),original:"Go to Declaration",mnemonicTitle:w.NC({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:M.Ao.and(m.u.hasDeclarationProvider,m.u.isInWalkThroughSnippet.toNegated()),menu:[{id:We.eH.EditorContext,group:"navigation",order:1.3},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?w.NC("decl.noResultWord","No declaration found for '{0}'",e.word):w.NC("decl.generic.noResults","No declaration found")}},Le.id="editor.action.revealDeclaration",Le)),(0,We.r1)(class extends Ze{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:{value:w.NC("actions.peekDecl.label","Peek Declaration"),original:"Peek Declaration"},precondition:M.Ao.and(m.u.hasDeclarationProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),menu:{id:We.eH.EditorContextPeek,group:"peek",order:3}})}});class Qe extends ze{_getLocationModel(e,t,i,n){return Be(this,void 0,void 0,(function*(){return new x.oQ(yield(0,Ke.L3)(e.typeDefinitionProvider,t,i,n),w.NC("typedef.title","Type Definitions"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):w.NC("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(55).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(55).multipleTypeDefinitions}}(0,We.r1)((Te=class e extends Qe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,title:{value:w.NC("actions.goToTypeDefinition.label","Go to Type Definition"),original:"Go to Type Definition",mnemonicTitle:w.NC({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:M.Ao.and(m.u.hasTypeDefinitionProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:0,weight:100},menu:[{id:We.eH.EditorContext,group:"navigation",order:1.4},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},Te.ID="editor.action.goToTypeDefinition",Te)),(0,We.r1)((Ee=class e extends Qe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,title:{value:w.NC("actions.peekTypeDefinition.label","Peek Type Definition"),original:"Peek Type Definition"},precondition:M.Ao.and(m.u.hasTypeDefinitionProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),menu:{id:We.eH.EditorContextPeek,group:"peek",order:4}})}},Ee.ID="editor.action.peekTypeDefinition",Ee));class qe extends ze{_getLocationModel(e,t,i,n){return Be(this,void 0,void 0,(function*(){return new x.oQ(yield(0,Ke.f4)(e.implementationProvider,t,i,n),w.NC("impl.title","Implementations"))}))}_getNoResultFoundMessage(e){return e&&e.word?w.NC("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):w.NC("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(55).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(55).multipleImplementations}}(0,We.r1)((Oe=class e extends qe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,title:{value:w.NC("actions.goToImplementation.label","Go to Implementations"),original:"Go to Implementations",mnemonicTitle:w.NC({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:M.Ao.and(m.u.hasImplementationProvider,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:2118,weight:100},menu:[{id:We.eH.EditorContext,group:"navigation",order:1.45},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},Oe.ID="editor.action.goToImplementation",Oe)),(0,We.r1)((Ae=class e extends qe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,title:{value:w.NC("actions.peekImplementation.label","Peek Implementations"),original:"Peek Implementations"},precondition:M.Ao.and(m.u.hasImplementationProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:3142,weight:100},menu:{id:We.eH.EditorContextPeek,group:"peek",order:5}})}},Ae.ID="editor.action.peekImplementation",Ae));class Xe extends ze{_getNoResultFoundMessage(e){return e?w.NC("references.no","No references found for '{0}'",e.word):w.NC("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(55).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(55).multipleReferences}}(0,We.r1)(class extends Xe{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{value:w.NC("goToReferences.label","Go to References"),original:"Go to References",mnemonicTitle:w.NC({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:M.Ao.and(m.u.hasReferenceProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:m.u.editorTextFocus,primary:1094,weight:100},menu:[{id:We.eH.EditorContext,group:"navigation",order:1.45},{id:We.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}_getLocationModel(e,t,i,n){return Be(this,void 0,void 0,(function*(){return new x.oQ(yield(0,Ke.aA)(e.referenceProvider,t,i,!0,n),w.NC("ref.title","References"))}))}}),(0,We.r1)(class extends Xe{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:{value:w.NC("references.action.label","Peek References"),original:"Peek References"},precondition:M.Ao.and(m.u.hasReferenceProvider,b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated()),menu:{id:We.eH.EditorContextPeek,group:"peek",order:6}})}_getLocationModel(e,t,i,n){return Be(this,void 0,void 0,(function*(){return new x.oQ(yield(0,Ke.aA)(e.referenceProvider,t,i,!1,n),w.NC("ref.title","References"))}))}});class Je extends ze{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:{value:w.NC("label.generic","Go to Any Symbol"),original:"Go to Any Symbol"},precondition:M.Ao.and(b.Jy.notInPeekEditor,m.u.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}_getLocationModel(e,t,i,n){return Be(this,void 0,void 0,(function*(){return new x.oQ(this._references,w.NC("generic.title","Locations"))}))}_getNoResultFoundMessage(e){return e&&w.NC("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){var t;return null!==(t=this._gotoMultipleBehaviour)&&void 0!==t?t:e.getOption(55).multipleReferences}_getAlternativeCommand(){return""}}S.P.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:l.o},{name:"position",description:"The position at which to start",constraint:_.L.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:(e,t,i,n,o,r,s)=>Be(void 0,void 0,void 0,(function*(){(0,d.p_)(l.o.isUri(t)),(0,d.p_)(_.L.isIPosition(i)),(0,d.p_)(Array.isArray(n)),(0,d.p_)("undefined"===typeof o||"string"===typeof o),(0,d.p_)("undefined"===typeof s||"boolean"===typeof s);const a=e.get(g.$),c=yield a.openCodeEditor({resource:t},a.getFocusedCodeEditor());if((0,h.CL)(c))return c.setPosition(i),c.revealPositionInCenterIfOutsideViewport(i,0),c.invokeWithinContext((e=>{const t=new class extends Je{_getNoResultFoundMessage(e){return r||super._getNoResultFoundMessage(e)}}({muteMessage:!Boolean(r),openInPeek:Boolean(s),openToSide:!1},n,o);e.get(D.TG).invokeFunction(t.run.bind(t),c)}))}))}),S.P.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:l.o},{name:"position",description:"The position at which to start",constraint:_.L.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(e,t,i,n,o)=>Be(void 0,void 0,void 0,(function*(){e.get(S.H).executeCommand("editor.action.goToLocations",t,i,n,o,void 0,!0)}))}),S.P.registerCommand({id:"editor.action.findReferences",handler:(e,t,i)=>{(0,d.p_)(l.o.isUri(t)),(0,d.p_)(_.L.isIPosition(i));const n=e.get(Ve.p),o=e.get(g.$);return o.openCodeEditor({resource:t},o.getFocusedCodeEditor()).then((e=>{if(!(0,h.CL)(e)||!e.hasModel())return;const t=ye.get(e);if(!t)return;const o=(0,r.PG)((t=>(0,Ke.aA)(n.referenceProvider,e.getModel(),_.L.lift(i),!1,t).then((e=>new x.oQ(e,w.NC("ref.title","References")))))),s=new f.e(i.lineNumber,i.column,i.lineNumber,i.column);return Promise.resolve(t.toggleWidget(s,o,!1))}))}}),S.P.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations")},18815:(e,t,i)=>{i.d(t,{L3:()=>p,aA:()=>_,f4:()=>g,nD:()=>h,zq:()=>u});var n=i(21921),o=i(55191),r=i(98642),s=i(48077),a=i(16458),d=i(7316),l=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};function c(e,t,i,o){return l(this,void 0,void 0,(function*(){const s=i.ordered(e),a=s.map((i=>Promise.resolve(o(i,e,t)).then(void 0,(e=>{(0,r.Cp)(e)})))),d=yield Promise.all(a);return(0,n.kX)(d.flat())}))}function h(e,t,i,n){return c(t,i,e,((e,t,i)=>e.provideDefinition(t,i,n)))}function u(e,t,i,n){return c(t,i,e,((e,t,i)=>e.provideDeclaration(t,i,n)))}function g(e,t,i,n){return c(t,i,e,((e,t,i)=>e.provideImplementation(t,i,n)))}function p(e,t,i,n){return c(t,i,e,((e,t,i)=>e.provideTypeDefinition(t,i,n)))}function _(e,t,i,n,o){return c(t,i,e,((e,t,i)=>l(this,void 0,void 0,(function*(){const r=yield e.provideReferences(t,i,{includeDeclaration:!0},o);if(!n||!r||2!==r.length)return r;const s=yield e.provideReferences(t,i,{includeDeclaration:!1},o);return s&&1===s.length?s:r}))))}function f(e){return l(this,void 0,void 0,(function*(){const t=yield e(),i=new d.oQ(t,""),n=i.references.map((e=>e.link));return i.dispose(),n}))}(0,s.sb)("_executeDefinitionProvider",((e,t,i)=>{const n=e.get(a.p),r=h(n.definitionProvider,t,i,o.T.None);return f((()=>r))})),(0,s.sb)("_executeTypeDefinitionProvider",((e,t,i)=>{const n=e.get(a.p),r=p(n.typeDefinitionProvider,t,i,o.T.None);return f((()=>r))})),(0,s.sb)("_executeDeclarationProvider",((e,t,i)=>{const n=e.get(a.p),r=u(n.declarationProvider,t,i,o.T.None);return f((()=>r))})),(0,s.sb)("_executeReferenceProvider",((e,t,i)=>{const n=e.get(a.p),r=_(n.referenceProvider,t,i,!1,o.T.None);return f((()=>r))})),(0,s.sb)("_executeImplementationProvider",((e,t,i)=>{const n=e.get(a.p),r=g(n.implementationProvider,t,i,o.T.None);return f((()=>r))}))},28130:(e,t,i)=>{i.d(t,{yN:()=>h});var n=i(11271),o=i(70959),r=i(47606);function s(e,t){return!!e[t]}class a{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.hasTriggerModifier=s(e.event,t.triggerModifier),this.hasSideBySideModifier=s(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class d{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=s(e,t.triggerModifier)}}class l{constructor(e,t,i,n){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function c(e){return"altKey"===e?r.dz?new l(57,"metaKey",6,"altKey"):new l(5,"ctrlKey",6,"altKey"):r.dz?new l(6,"altKey",57,"metaKey"):new l(6,"altKey",5,"ctrlKey")}class h extends o.JT{constructor(e,t){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new n.Q5),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new n.Q5),this.onExecute=this._onExecute.event,this._onCancel=this._register(new n.Q5),this.onCancel=this._onCancel.event,this._editor=e,this._alwaysFireExecuteOnMouseUp=t,this._opts=c(this._editor.getOption(74)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration((e=>{if(e.hasChanged(74)){const e=c(this._editor.getOption(74));if(this._opts.equals(e))return;this._opts=e,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}}))),this._register(this._editor.onMouseMove((e=>this._onEditorMouseMove(new a(e,this._opts))))),this._register(this._editor.onMouseDown((e=>this._onEditorMouseDown(new a(e,this._opts))))),this._register(this._editor.onMouseUp((e=>this._onEditorMouseUp(new a(e,this._opts))))),this._register(this._editor.onKeyDown((e=>this._onEditorKeyDown(new d(e,this._opts))))),this._register(this._editor.onKeyUp((e=>this._onEditorKeyUp(new d(e,this._opts))))),this._register(this._editor.onMouseDrag((()=>this._resetHandler()))),this._register(this._editor.onDidChangeCursorSelection((e=>this._onDidChangeCursorSelection(e)))),this._register(this._editor.onDidChangeModel((e=>this._resetHandler()))),this._register(this._editor.onDidChangeModelContent((()=>this._resetHandler()))),this._register(this._editor.onDidScrollChange((e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this._resetHandler()})))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=e.target.position?e.target.position.lineNumber:0}_onEditorMouseUp(e){const t=e.target.position?e.target.position.lineNumber:0;(this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t||this._alwaysFireExecuteOnMouseUp)&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}},20713:(e,t,i)=>{i.r(t),i.d(t,{GotoDefinitionAtPositionEditorContribution:()=>k});var n=i(85398),o=i(98642),r=i(81478),s=i(70959),a=i(55455),d=i(39363),l=i(48077),c=i(33162),h=i(61141),u=i(15498),g=i(28130),p=i(78097),_=i(25206),f=i(66538),m=i(68703),v=i(18815),C=i(16458),y=i(16375),b=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},w=function(e,t){return function(i,n){t(i,n,e)}},S=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};let k=class e{constructor(e,t,i,n){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=n,this.toUnhook=new s.SL,this.toUnhookForKeyboard=new s.SL,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const r=new g.yN(e);this.toUnhook.add(r),this.toUnhook.add(r.onMouseMoveOrRelevantKeyDown((([e,t])=>{this.startFindDefinitionFromMouse(e,(0,a.f6)(t))}))),this.toUnhook.add(r.onExecute((e=>{this.isEnabled(e)&&this.gotoDefinition(e.target.position,e.hasSideBySideModifier).catch((e=>{(0,o.dL)(e)})).finally((()=>{this.removeLinkDecorations()}))}))),this.toUnhook.add(r.onCancel((()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null})))}static get(t){return t.getContribution(e.ID)}startFindDefinitionFromCursor(e){return S(this,void 0,void 0,(function*(){yield this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition((()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()}))),this.toUnhookForKeyboard.add(this.editor.onKeyDown((e=>{e&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())})))}))}startFindDefinitionFromMouse(e,t){if(9===e.target.type&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t))return this.currentWordAtPosition=null,void this.removeLinkDecorations();const i=e.target.position;this.startFindDefinition(i)}startFindDefinition(e){var t;return S(this,void 0,void 0,(function*(){this.toUnhookForKeyboard.clear();const i=e?null===(t=this.editor.getModel())||void 0===t?void 0:t.getWordAtPosition(e):null;if(!i)return this.currentWordAtPosition=null,void this.removeLinkDecorations();if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===i.startColumn&&this.currentWordAtPosition.endColumn===i.endColumn&&this.currentWordAtPosition.word===i.word)return;this.currentWordAtPosition=i;const s=new d.yy(this.editor,15);let a;this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=(0,n.PG)((t=>this.findDefinition(e,t)));try{a=yield this.previousPromise}catch(h){return void(0,o.dL)(h)}if(!a||!a.length||!s.validate(this.editor))return void this.removeLinkDecorations();const l=a[0].originSelectionRange?c.e.lift(a[0].originSelectionRange):new c.e(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn);if(a.length>1){let e=l;for(const{originSelectionRange:t}of a)t&&(e=c.e.plusRange(e,t));this.addDecoration(e,(new r.W5).appendText(_.NC("multipleResults","Click to show {0} definitions.",a.length)))}else{const e=a[0];if(!e.uri)return;this.textModelResolverService.createModelReference(e.uri).then((t=>{if(!t.object||!t.object.textEditorModel)return void t.dispose();const{object:{textEditorModel:i}}=t,{startLineNumber:n}=e.range;if(n<1||n>i.getLineCount())return void t.dispose();const o=this.getPreviewValue(i,n,e),s=this.languageService.guessLanguageIdByFilepathOrFirstLine(i.uri);this.addDecoration(l,o?(new r.W5).appendCodeblock(s||"",o):void 0),t.dispose()}))}}))}getPreviewValue(t,i,n){let o=n.range;const r=o.endLineNumber-o.startLineNumber;r>=e.MAX_SOURCE_PREVIEW_LINES&&(o=this.getPreviewRangeBasedOnIndentation(t,i));const s=this.stripIndentationFromPreviewRange(t,i,o);return s}stripIndentationFromPreviewRange(e,t,i){const n=e.getLineFirstNonWhitespaceColumn(t);let o=n;for(let s=t+1;s<i.endLineNumber;s++){const t=e.getLineFirstNonWhitespaceColumn(s);o=Math.min(o,t)}const r=e.getValueInRange(i).replace(new RegExp(`^\\s{${o-1}}`,"gm"),"").trim();return r}getPreviewRangeBasedOnIndentation(t,i){const n=t.getLineFirstNonWhitespaceColumn(i),o=Math.min(t.getLineCount(),i+e.MAX_SOURCE_PREVIEW_LINES);let r=i+1;for(;r<o;r++){const e=t.getLineFirstNonWhitespaceColumn(r);if(n===e)break}return new c.e(i,1,r+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){var i;return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&6===e.target.type&&!((null===(i=e.target.detail.injectedText)||void 0===i?void 0:i.options)instanceof y.HS)&&(e.hasTriggerModifier||!!t&&t.keyCodeIsTriggerKey)&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?(0,v.nD)(this.languageFeaturesService.definitionProvider,i,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext((e=>{const i=!t&&this.editor.getOption(83)&&!this.isInPeekEditor(e),n=new m.DefinitionAction({openToSide:t,openInPeek:i,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0});return n.run(e)}))}isInPeekEditor(e){const t=e.get(f.i6);return p.Jy.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}};k.ID="editor.contrib.gotodefinitionatposition",k.MAX_SOURCE_PREVIEW_LINES=8,k=b([w(1,u.S),w(2,h.O),w(3,C.p)],k),(0,l._K)(k.ID,k,2)},7316:(e,t,i)=>{i.d(t,{F2:()=>_,WX:()=>g,oQ:()=>f});var n=i(98642),o=i(11271),r=i(58247),s=i(70959),a=i(71400),d=i(21230),l=i(61720),c=i(33162),h=i(25206),u=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};class g{constructor(e,t,i,n){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=n,this.id=r.a.nextId()}get uri(){return this.link.uri}get range(){var e,t;return null!==(t=null!==(e=this._range)&&void 0!==e?e:this.link.targetSelectionRange)&&void 0!==t?t:this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){var e;const t=null===(e=this.parent.getPreview(this))||void 0===e?void 0:e.preview(this.range);return t?(0,h.NC)({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"symbol in {0} on line {1} at column {2}, {3}",(0,d.EZ)(this.uri),this.range.startLineNumber,this.range.startColumn,t.value):(0,h.NC)("aria.oneReference","symbol in {0} on line {1} at column {2}",(0,d.EZ)(this.uri),this.range.startLineNumber,this.range.startColumn)}}class p{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:n,startColumn:o,endLineNumber:r,endColumn:s}=e,a=i.getWordUntilPosition({lineNumber:n,column:o-t}),d=new c.e(n,a.startColumn,n,o),l=new c.e(r,s,r,1073741824),h=i.getValueInRange(d).replace(/^\s+/,""),u=i.getValueInRange(e),g=i.getValueInRange(l).replace(/\s+$/,"");return{value:h+u+g,highlight:{start:h.length,end:h.length+u.length}}}}class _{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new a.Y9}dispose(){(0,s.B9)(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return 1===e?(0,h.NC)("aria.fileReferences.1","1 symbol in {0}, full path {1}",(0,d.EZ)(this.uri),this.uri.fsPath):(0,h.NC)("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,(0,d.EZ)(this.uri),this.uri.fsPath)}resolve(e){return u(this,void 0,void 0,(function*(){if(0!==this._previews.size)return this;for(const i of this.children)if(!this._previews.has(i.uri))try{const t=yield e.createModelReference(i.uri);this._previews.set(i.uri,new p(t))}catch(t){(0,n.dL)(t)}return this}))}}class f{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new o.Q5,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;let n;e.sort(f._compareReferences);for(const o of e)if(n&&d.SF.isEqual(n.uri,o.uri,!0)||(n=new _(this,o.uri),this.groups.push(n)),0===n.children.length||0!==f._compareReferences(o,n.children[n.children.length-1])){const e=new g(i===o,n,o,(e=>this._onDidChangeReferenceRange.fire(e)));this.references.push(e),n.children.push(e)}}dispose(){(0,s.B9)(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new f(this._links,this._title)}get title(){return this._title}get isEmpty(){return 0===this.groups.length}get ariaMessage(){return this.isEmpty?(0,h.NC)("aria.result.0","No results found"):1===this.references.length?(0,h.NC)("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):1===this.groups.length?(0,h.NC)("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):(0,h.NC)("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let n=i.children.indexOf(e);const o=i.children.length,r=i.parent.groups.length;return 1===r||t&&n+1<o||!t&&n>0?(n=t?(n+1)%o:(n+o-1)%o,i.children[n]):(n=i.parent.groups.indexOf(i),t?(n=(n+1)%r,i.parent.groups[n].children[0]):(n=(n+r-1)%r,i.parent.groups[n].children[i.parent.groups[n].children.length-1]))}nearestReference(e,t){const i=this.references.map(((i,n)=>({idx:n,prefixLen:l.Mh(i.uri.toString(),e.toString()),offsetDist:100*Math.abs(i.range.startLineNumber-t.lineNumber)+Math.abs(i.range.startColumn-t.column)}))).sort(((e,t)=>e.prefixLen>t.prefixLen?-1:e.prefixLen<t.prefixLen?1:e.offsetDist<t.offsetDist?-1:e.offsetDist>t.offsetDist?1:0))[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&c.e.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return d.SF.compare(e.uri,t.uri)||c.e.compareRangesUsingStarts(e.range,t.range)}}},48864:(e,t,i)=>{i.d(t,{R8:()=>h});var n=i(85398),o=i(55191),r=i(98642),s=i(48077),a=i(16458),d=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};class l{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}function c(e,t,i,n,o){return d(this,void 0,void 0,(function*(){try{const r=yield Promise.resolve(e.provideHover(i,n,o));if(r&&g(r))return new l(e,r,t)}catch(s){(0,r.Cp)(s)}}))}function h(e,t,i,o){const r=e.ordered(t),s=r.map(((e,n)=>c(e,n,t,i,o)));return n.Aq.fromPromises(s).coalesce()}function u(e,t,i,n){return h(e,t,i,n).map((e=>e.hover)).toPromise()}function g(e){const t="undefined"!==typeof e.range,i="undefined"!==typeof e.contents&&e.contents&&e.contents.length>0;return t&&i}(0,s.sb)("_executeHoverProvider",((e,t,i)=>{const n=e.get(a.p);return u(n.hoverProvider,t,i,o.T.None)}))},36402:(e,t,i)=>{i.r(t),i.d(t,{ModesHoverController:()=>ot});var n=i(56082),o=i(70959),r=i(48077),s=i(33162),a=i(44950),d=i(61141),l=i(20713),c=i(2548),h=i(90422),u=i(21921),g=i(89999),p=i(16375),_=i(67026),f=i(85398),m=i(98642),v=i(11271),C=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))},y=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,r){t=e[i](t),o(n,r,t.done,t.value)}))}}function o(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)}};class b{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}}class w extends o.JT{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new v.Q5),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new f.pY((()=>this._triggerAsyncComputation()),0)),this._secondWaitScheduler=this._register(new f.pY((()=>this._triggerSyncComputation()),0)),this._loadingMessageScheduler=this._register(new f.pY((()=>this._triggerLoadingMessage()),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(57).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=(0,f.zS)((e=>this._computer.computeAsync(e))),(()=>{C(this,void 0,void 0,(function*(){var e,t,i,n;try{try{for(var o,r=!0,s=y(this._asyncIterable);o=yield s.next(),e=o.done,!e;){n=o.value,r=!1;try{const e=n;e&&(this._result.push(e),this._fireResult())}finally{r=!0}}}catch(a){t={error:a}}finally{try{r||e||!(i=s.return)||(yield i.call(s))}finally{if(t)throw t.error}}this._asyncIterableDone=!0,3!==this._state&&4!==this._state||this._setState(0)}catch(d){(0,m.dL)(d)}}))})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){3===this._state&&this._setState(4)}_fireResult(){if(1===this._state||2===this._state)return;const e=0===this._state,t=4===this._state;this._onResult.fire(new b(this._result.slice(0),e,t))}start(e){if(0===e)0===this._state&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}var S=i(97791),k=i(66538),M=i(21881),D=i(15285),P=i(49864),N=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},R=function(e,t){return function(i,n){t(i,n,e)}};const I=c.$;let x=class e extends o.JT{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._widget=this._register(this._instantiationService.createInstance(O,this._editor)),this._currentResult=null,this._participants=[];for(const n of S.Ae.getAll())this._participants.push(this._instantiationService.createInstance(n,this._editor));this._participants.sort(((e,t)=>e.hoverOrdinal-t.hoverOrdinal)),this._computer=new F(this._editor,this._participants),this._hoverOperation=this._register(new w(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{if(!this._computer.anchor)return;const t=e.hasLoadingMessage?this._addLoadingMessage(e.value):e.value;this._withResult(new L(this._computer.anchor,t,e.isComplete))}))),this._register(c.mu(this._widget.getDomNode(),"keydown",(e=>{e.equals(9)&&this.hide()}))),this._register(_.RW.onDidChange((()=>{this._widget.position&&this._currentResult&&(this._widget.clear(),this._setCurrentResult(this._currentResult))})))}maybeShowAt(e){const t=[];for(const n of this._participants)if(n.suggestHoverAnchor){const i=n.suggestHoverAnchor(e);i&&t.push(i)}const i=e.target;if(6===i.type&&t.push(new S.Qj(0,i.range,e.event.posx,e.event.posy)),7===i.type){const n=this._editor.getOption(47).typicalHalfwidthCharacterWidth/2;!i.detail.isAfterLines&&"number"===typeof i.detail.horizontalDistanceToText&&i.detail.horizontalDistanceToText<n&&t.push(new S.Qj(0,i.range,e.event.posx,e.event.posy))}return 0===t.length?this._startShowingOrUpdateHover(null,0,0,!1,e):(t.sort(((e,t)=>t.priority-e.priority)),this._startShowingOrUpdateHover(t[0],0,0,!1,e))}startShowingAtRange(e,t,i,n){this._startShowingOrUpdateHover(new S.Qj(0,e,void 0,void 0),t,i,n,null)}_startShowingOrUpdateHover(e,t,i,n,o){if(!this._widget.position||!this._currentResult)return!!e&&(this._startHoverOperationIfNecessary(e,t,i,n,!1),!0);const r=this._editor.getOption(57).sticky,s=r&&o&&this._widget.isMouseGettingCloser(o.event.posx,o.event.posy);return s?(e&&this._startHoverOperationIfNecessary(e,t,i,n,!0),!0):e?!(!e||!this._currentResult.anchor.equals(e))||(e.canAdoptVisibleHover(this._currentResult.anchor,this._widget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0)):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,n,o){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=n,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=o,this._hoverOperation.start(t))}_setCurrentResult(e){this._currentResult!==e&&(e&&0===e.messages.length&&(e=null),this._currentResult=e,this._currentResult?this._renderMessages(this._currentResult.anchor,this._currentResult.messages):this._widget.hide())}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}isColorPickerVisible(){return this._widget.isColorPickerVisible}isVisibleFromKeyboard(){return this._widget.isVisibleFromKeyboard}containsNode(e){return this._widget.getDomNode().contains(e)}_addLoadingMessage(e){if(this._computer.anchor)for(const t of this._participants)if(t.createLoadingMessage){const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}return e}_withResult(e){if(this._widget.position&&this._currentResult&&this._currentResult.isComplete){if(!e.isComplete)return;if(this._computer.insistOnKeepingHoverVisible&&0===e.messages.length)return}this._setCurrentResult(e)}_renderMessages(t,i){const{showAtPosition:n,showAtSecondaryPosition:r,highlightRange:s}=e.computeHoverRanges(this._editor,t.range,i),a=new o.SL,d=a.add(new A(this._keybindingService)),l=document.createDocumentFragment();let c=null;const h={fragment:l,statusBar:d,setColorPicker:e=>c=e,onContentsChanged:()=>this._widget.onContentsChanged(),hide:()=>this.hide()};for(const e of this._participants){const t=i.filter((t=>t.owner===e));t.length>0&&a.add(e.renderHoverParts(h,t))}const u=i.some((e=>e.isBeforeContent));if(d.hasContent&&l.appendChild(d.hoverElement),l.hasChildNodes()){if(s){const t=this._editor.createDecorationsCollection();t.set([{range:s,options:e._DECORATION_OPTIONS}]),a.add((0,o.OF)((()=>{t.clear()})))}this._widget.showAt(l,new E(c,n,r,this._editor.getOption(57).above,this._computer.shouldFocus,this._computer.source,u,t.initialMousePosX,t.initialMousePosY,a))}else a.dispose()}static computeHoverRanges(e,t,i){let n=1;if(e.hasModel()){const i=e._getViewModel(),o=i.coordinatesConverter,r=o.convertModelRangeToViewRange(t),s=new g.L(r.startLineNumber,i.getLineMinColumn(r.startLineNumber));n=o.convertViewPositionToModelPosition(s).column}const o=t.startLineNumber;let r=t.startColumn,a=i[0].range,d=null;for(const l of i)a=s.e.plusRange(a,l.range),l.range.startLineNumber===o&&l.range.endLineNumber===o&&(r=Math.max(Math.min(r,l.range.startColumn),n)),l.forceShowAtRange&&(d=l.range);return{showAtPosition:d?d.getStartPosition():new g.L(o,t.startColumn),showAtSecondaryPosition:d?d.getStartPosition():new g.L(o,r),highlightRange:a}}};x._DECORATION_OPTIONS=p.qx.register({description:"content-hover-highlight",className:"hoverHighlight"}),x=N([R(1,M.TG),R(2,D.d)],x);class L{constructor(e,t,i){this.anchor=e,this.messages=t,this.isComplete=i}filter(e){const t=this.messages.filter((t=>t.isValidForHoverAnchor(e)));return t.length===this.messages.length?this:new T(this,this.anchor,t,this.isComplete)}}class T extends L{constructor(e,t,i,n){super(t,i,n),this.original=e}filter(e){return this.original.filter(e)}}class E{constructor(e,t,i,n,o,r,s,a,d,l){this.colorPicker=e,this.showAtPosition=t,this.showAtSecondaryPosition=i,this.preferAbove=n,this.stoleFocus=o,this.source=r,this.isBeforeContent=s,this.initialMousePosX=a,this.initialMousePosY=d,this.disposables=l,this.closestMouseDistance=void 0}}let O=class e extends o.JT{get position(){var e,t;return null!==(t=null===(e=this._visibleData)||void 0===e?void 0:e.showAtPosition)&&void 0!==t?t:null}get isColorPickerVisible(){var e;return Boolean(null===(e=this._visibleData)||void 0===e?void 0:e.colorPicker)}get isVisibleFromKeyboard(){var e;return 1===(null===(e=this._visibleData)||void 0===e?void 0:e.source)}constructor(e,t){super(),this._editor=e,this._contextKeyService=t,this.allowEditorOverflow=!0,this._hoverVisibleKey=a.u.hoverVisible.bindTo(this._contextKeyService),this._hover=this._register(new h.c),this._visibleData=null,this._register(this._editor.onDidLayoutChange((()=>this._layout()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(47)&&this._updateFont()}))),this._setVisibleData(null),this._layout(),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),this._visibleData&&this._visibleData.disposables.dispose(),super.dispose()}getId(){return e.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){if(!this._visibleData)return null;let e=this._visibleData.preferAbove;!e&&this._contextKeyService.getContextKeyValue(P._y.Visible.key)&&(e=!0);const t=this._visibleData.isBeforeContent?3:void 0;return{position:this._visibleData.showAtPosition,secondaryPosition:this._visibleData.showAtSecondaryPosition,preference:e?[1,2]:[2,1],positionAffinity:t}}isMouseGettingCloser(e,t){if(!this._visibleData)return!1;if("undefined"===typeof this._visibleData.initialMousePosX||"undefined"===typeof this._visibleData.initialMousePosY)return this._visibleData.initialMousePosX=e,this._visibleData.initialMousePosY=t,!1;const i=c.i(this.getDomNode());"undefined"===typeof this._visibleData.closestMouseDistance&&(this._visibleData.closestMouseDistance=W(this._visibleData.initialMousePosX,this._visibleData.initialMousePosY,i.left,i.top,i.width,i.height));const n=W(e,t,i.left,i.top,i.width,i.height);return!(n>this._visibleData.closestMouseDistance+4)&&(this._visibleData.closestMouseDistance=Math.min(this._visibleData.closestMouseDistance,n),!0)}_setVisibleData(e){this._visibleData&&this._visibleData.disposables.dispose(),this._visibleData=e,this._hoverVisibleKey.set(!!this._visibleData),this._hover.containerDomNode.classList.toggle("hidden",!this._visibleData)}_layout(){const e=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:t,lineHeight:i}=this._editor.getOption(47);this._hover.contentsDomNode.style.fontSize=`${t}px`,this._hover.contentsDomNode.style.lineHeight=""+i/t,this._hover.contentsDomNode.style.maxHeight=`${e}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(.66*this._editor.getLayoutInfo().width,500)}px`}_updateFont(){const e=Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code"));e.forEach((e=>this._editor.applyFontInfo(e)))}showAt(e,t){var i;this._setVisibleData(t),this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._hover.contentsDomNode.style.paddingBottom="",this._updateFont(),this.onContentsChanged(),this._editor.render(),this.onContentsChanged(),t.stoleFocus&&this._hover.containerDomNode.focus(),null===(i=t.colorPicker)||void 0===i||i.layout()}hide(){if(this._visibleData){const e=this._visibleData.stoleFocus;this._setVisibleData(null),this._editor.layoutContentWidget(this),e&&this._editor.focus()}}onContentsChanged(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged();const e=this._hover.scrollbar.getScrollDimensions(),t=e.scrollWidth>e.width;if(t){const e=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingBottom!==e&&(this._hover.contentsDomNode.style.paddingBottom=e,this._editor.layoutContentWidget(this),this._hover.onContentsChanged())}}clear(){this._hover.contentsDomNode.textContent=""}};O.ID="editor.contrib.contentHoverWidget",O=N([R(1,k.i6)],O);let A=class extends o.JT{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=I("div.hover-row.status-bar"),this.actionsElement=c.R3(this.hoverElement,I("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;return this._hasContent=!0,this._register(h.S.render(this.actionsElement,e,i))}append(e){const t=c.R3(this.actionsElement,e);return this._hasContent=!0,t}};A=N([R(0,D.d)],A);class F{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(1!==t.type&&!t.supportsMarkerHover)return[];const i=e.getModel(),n=t.range.startLineNumber;if(n>i.getLineCount())return[];const o=i.getLineMaxColumn(n);return e.getLineDecorations(n).filter((e=>{if(e.options.isWholeLine)return!0;const i=e.range.startLineNumber===n?e.range.startColumn:1,r=e.range.endLineNumber===n?e.range.endColumn:o;if(e.options.showIfCollapsed){if(i>t.range.startColumn+1||t.range.endColumn-1>r)return!1}else if(i>t.range.startColumn||t.range.endColumn>r)return!1;return!0}))}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return f.Aq.EMPTY;const i=F._getLineDecorations(this._editor,t);return f.Aq.merge(this._participants.map((n=>n.computeAsync?n.computeAsync(t,i,e):f.Aq.EMPTY)))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=F._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return(0,u.kX)(t)}}function W(e,t,i,n,o,r){const s=i+o/2,a=n+r/2,d=Math.max(Math.abs(e-s)-o/2,0),l=Math.max(Math.abs(t-a)-r/2,0);return Math.sqrt(d*d+l*l)}var H=i(81478),K=i(92767);const V=c.$;class U extends o.JT{constructor(e,t,i){super(),this._renderDisposeables=this._register(new o.SL),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new h.c),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new K.$({editor:this._editor},t,i)),this._computer=new B(this._editor),this._hoverOperation=this._register(new w(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{this._withResult(e.value)}))),this._register(this._editor.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(47)&&this._updateFont()}))),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return U.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){const e=Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code"));e.forEach((e=>this._editor.applyFontInfo(e)))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(e){this._computer.lineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const n of t){const e=V("div.hover-row.markdown-hover"),t=c.R3(e,V("div.hover-contents")),o=this._renderDisposeables.add(this._markdownRenderer.render(n.value));t.appendChild(o.element),i.appendChild(e)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),n=this._editor.getScrollTop(),o=this._editor.getOption(63),r=this._hover.containerDomNode.clientHeight,s=i-n-(r-o)/2;this._hover.containerDomNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(s),0)}px`}}U.ID="editor.contrib.modesGlyphHoverWidget";class B{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}constructor(e){this._editor=e,this._lineNumber=-1}computeSync(){const e=e=>({value:e}),t=this._editor.getLineDecorations(this._lineNumber),i=[];if(!t)return i;for(const n of t){if(!n.options.glyphMarginClassName)continue;const t=n.options.glyphMarginHoverMessage;t&&!(0,H.CP)(t)&&i.push(...(0,u._2)(t).map(e))}return i}}var G=i(25206),z=i(6544),$=i(47277),j=i(32656),Z=i(25903),Q=i(21230),q=i(54693),X=i(88266),J=i(92410),Y=i(7710),ee=i(8419),te=i(35195),ie=i(33010),ne=i(61720),oe=i(95896),re=i(39326),se=i(48580),ae=i(47596),de=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},le=function(e,t){return function(i,n){t(i,n,e)}};class ce{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let he=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new v.Q5,this.onDidChange=this._onDidChange.event,this._dispoables=new o.SL,this._markers=[],this._nextIdx=-1,oe.o.isUri(e)?this._resourceFilter=t=>t.toString()===e.toString():e&&(this._resourceFilter=e);const n=this._configService.getValue("problems.sortOrder"),r=(e,t)=>{let i=(0,ne.qu)(e.resource.toString(),t.resource.toString());return 0===i&&(i="position"===n?s.e.compareRangesUsingStarts(e,t)||se.ZL.compare(e.severity,t.severity):se.ZL.compare(e.severity,t.severity)||s.e.compareRangesUsingStarts(e,t)),i},a=()=>{this._markers=this._markerService.read({resource:oe.o.isUri(e)?e:void 0,severities:se.ZL.Error|se.ZL.Warning|se.ZL.Info}),"function"===typeof e&&(this._markers=this._markers.filter((e=>this._resourceFilter(e.resource)))),this._markers.sort(r)};a(),this._dispoables.add(t.onMarkerChanged((e=>{this._resourceFilter&&!e.some((e=>this._resourceFilter(e)))||(a(),this._nextIdx=-1,this._onDidChange.fire())})))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e||!(!this._resourceFilter||!e)&&this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new ce(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let n=!1,o=this._markers.findIndex((t=>t.resource.toString()===e.uri.toString()));o<0&&(o=(0,u.ry)(this._markers,{resource:e.uri},((e,t)=>(0,ne.qu)(e.resource.toString(),t.resource.toString()))),o<0&&(o=~o));for(let r=o;r<this._markers.length;r++){let i=s.e.lift(this._markers[r]);if(i.isEmpty()){const t=e.getWordAtPosition(i.getStartPosition());t&&(i=new s.e(i.startLineNumber,t.startColumn,i.startLineNumber,t.endColumn))}if(t&&(i.containsPosition(t)||t.isBeforeOrEqual(i.getStartPosition()))){this._nextIdx=r,n=!0;break}if(this._markers[r].resource.toString()!==e.uri.toString())break}n||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(0===this._markers.length)return!1;const n=this._nextIdx;return-1===this._nextIdx?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),n!==this._nextIdx}find(e,t){let i=this._markers.findIndex((t=>t.resource.toString()===e.toString()));if(!(i<0))for(;i<this._markers.length;i++)if(s.e.containsPosition(this._markers[i],t))return new ce(this._markers[i],i+1,this._markers.length)}};he=de([le(1,se.lT),le(2,ae.Ui)],he);const ue=(0,M.yh)("IMarkerNavigationService");let ge=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new ie.S}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new he(e,this._markerService,this._configService)}};ge=de([le(0,se.lT),le(1,ae.Ui)],ge),(0,re.z)(ue,ge,1);var pe=i(82693),_e=i(98158),fe=i(67225),me=i(60204),ve=i(78097),Ce=i(94700),ye=i(51549),be=i(12898),we=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},Se=function(e,t){return function(i,n){t(i,n,e)}};class ke{constructor(e,t,i,n,r){this._openerService=n,this._labelService=r,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new o.SL,this._editor=t;const s=document.createElement("div");s.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),s.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),s.appendChild(this._relatedBlock),this._disposables.add(c.mu(this._relatedBlock,"click",(e=>{e.preventDefault();const t=this._relatedDiagnostics.get(e.target);t&&i(t)}))),this._scrollable=new fe.NB(s,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((e=>{s.style.left=`-${e.scrollLeft}px`,s.style.top=`-${e.scrollTop}px`}))),this._disposables.add(this._scrollable)}dispose(){(0,o.B9)(this._disposables)}update(e){const{source:t,message:i,relatedInformation:n,code:o}=e;let r=((null===t||void 0===t?void 0:t.length)||0)+"()".length;o&&(r+="string"===typeof o?o.length:o.value.length);const s=(0,ne.uq)(i);this._lines=s.length,this._longestLineLength=0;for(const c of s)this._longestLineLength=Math.max(c.length+r,this._longestLineLength);c.PO(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let a=this._messageBlock;for(const c of s)a=document.createElement("div"),a.innerText=c,""===c&&(a.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(a);if(t||o){const e=document.createElement("span");if(e.classList.add("details"),a.appendChild(e),t){const i=document.createElement("span");i.innerText=t,i.classList.add("source"),e.appendChild(i)}if(o)if("string"===typeof o){const t=document.createElement("span");t.innerText=`(${o})`,t.classList.add("code"),e.appendChild(t)}else{this._codeLink=c.$("a.code-link"),this._codeLink.setAttribute("href",`${o.target.toString()}`),this._codeLink.onclick=e=>{this._openerService.open(o.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()};const t=c.R3(this._codeLink,c.$("span"));t.innerText=o.value,e.appendChild(this._codeLink)}}if(c.PO(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),(0,u.Of)(n)){const e=this._relatedBlock.appendChild(document.createElement("div"));e.style.paddingTop=`${Math.floor(.66*this._editor.getOption(63))}px`,this._lines+=1;for(const t of n){const i=document.createElement("div"),n=document.createElement("a");n.classList.add("filename"),n.innerText=`${this._labelService.getUriBasenameLabel(t.resource)}(${t.startLineNumber}, ${t.startColumn}): `,n.title=this._labelService.getUriLabel(t.resource),this._relatedDiagnostics.set(n,t);const o=document.createElement("span");o.innerText=t.message,i.appendChild(n),i.appendChild(o),this._lines+=1,e.appendChild(i)}}const d=this._editor.getOption(47),l=Math.ceil(d.typicalFullwidthCharacterWidth*this._longestLineLength*.75),h=d.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:l,scrollHeight:h})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case se.ZL.Error:t=G.NC("Error","Error");break;case se.ZL.Warning:t=G.NC("Warning","Warning");break;case se.ZL.Info:t=G.NC("Info","Info");break;case se.ZL.Hint:t=G.NC("Hint","Hint");break}let i=G.NC("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const n=this._editor.getModel();if(n&&e.startLineNumber<=n.getLineCount()&&e.startLineNumber>=1){const t=n.getLineContent(e.startLineNumber);i=`${t}, ${i}`}return i}}let Me=class e extends ve.vk{constructor(e,t,i,n,r,s,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},r),this._themeService=t,this._openerService=i,this._menuService=n,this._contextKeyService=s,this._labelService=a,this._callOnDispose=new o.SL,this._onDidSelectRelatedInformation=new v.Q5,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=se.ZL.Warning,this._backgroundColor=me.Il.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(Oe);let t=Re,i=Ie;this._severity===se.ZL.Warning?(t=xe,i=Le):this._severity===se.ZL.Info&&(t=Te,i=Ee);const n=e.getColor(t),o=e.getColor(i);this.style({arrowColor:n,frameColor:n,headerBackgroundColor:o,primaryHeadingColor:e.getColor(ve.IH),secondaryHeadingColor:e.getColor(ve.R7)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(t){super._fillHead(t),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun((e=>this.editor.focus())));const i=[],n=this._menuService.createMenu(e.TitleMenu,this._contextKeyService);(0,Ce.vr)(n,void 0,i),this._actionbarWidget.push(i,{label:!1,icon:!0,index:0}),n.dispose()}_fillTitleIcon(e){this._icon=c.R3(e,c.$(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new ke(this._container,this.editor,(e=>this._onDidSelectRelatedInformation.fire(e)),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const n=s.e.lift(e),o=this.editor.getPosition(),r=o&&n.containsPosition(o)?o:n.getStartPosition();super.show(r,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const e=i>1?G.NC("problems","{0} of {1} problems",t,i):G.NC("change","{0} of {1} problem",t,i);this.setTitle((0,Q.EZ)(a.uri),e)}this._icon.className=`codicon ${be.j.className(se.ZL.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};Me.TitleMenu=new pe.eH("gotoErrorTitleMenu"),Me=we([Se(1,j.XE),Se(2,z.v4),Se(3,pe.co),Se(4,M.TG),Se(5,k.i6),Se(6,ye.e)],Me);const De=(0,$.kwl)($.lXJ,$.b6y),Pe=(0,$.kwl)($.uoC,$.pW3),Ne=(0,$.kwl)($.c63,$.T83),Re=(0,$.P6G)("editorMarkerNavigationError.background",{dark:De,light:De,hcDark:$.lRK,hcLight:$.lRK},G.NC("editorMarkerNavigationError","Editor marker navigation widget error color.")),Ie=(0,$.P6G)("editorMarkerNavigationError.headerBackground",{dark:(0,$.ZnX)(Re,.1),light:(0,$.ZnX)(Re,.1),hcDark:null,hcLight:null},G.NC("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),xe=(0,$.P6G)("editorMarkerNavigationWarning.background",{dark:Pe,light:Pe,hcDark:$.lRK,hcLight:$.lRK},G.NC("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),Le=(0,$.P6G)("editorMarkerNavigationWarning.headerBackground",{dark:(0,$.ZnX)(xe,.1),light:(0,$.ZnX)(xe,.1),hcDark:"#0C141F",hcLight:(0,$.ZnX)(xe,.2)},G.NC("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),Te=(0,$.P6G)("editorMarkerNavigationInfo.background",{dark:Ne,light:Ne,hcDark:$.lRK,hcLight:$.lRK},G.NC("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),Ee=(0,$.P6G)("editorMarkerNavigationInfo.headerBackground",{dark:(0,$.ZnX)(Te,.1),light:(0,$.ZnX)(Te,.1),hcDark:null,hcLight:null},G.NC("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),Oe=(0,$.P6G)("editorMarkerNavigation.background",{dark:$.cvW,light:$.cvW,hcDark:$.cvW,hcLight:$.cvW},G.NC("editorMarkerNavigationBackground","Editor marker navigation widget background."));var Ae=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},Fe=function(e,t){return function(i,n){t(i,n,e)}},We=function(e,t,i,n){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function s(e){try{d(n.next(e))}catch(t){r(t)}}function a(e){try{d(n["throw"](e))}catch(t){r(t)}}function d(e){e.done?i(e.value):o(e.value).then(s,a)}d((n=n.apply(e,t||[])).next())}))};let He=class e{static get(t){return t.getContribution(e.ID)}constructor(e,t,i,n,r){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=n,this._instantiationService=r,this._sessionDispoables=new o.SL,this._editor=e,this._widgetVisible=ze.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(Me,this._editor),this._widget.onDidClose((()=>this.close()),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((e=>{var t,i,n;(null===(t=this._model)||void 0===t?void 0:t.selected)&&s.e.containsPosition(null===(i=this._model)||void 0===i?void 0:i.selected.marker,e.position)||null===(n=this._model)||void 0===n||n.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((()=>{if(!this._widget||!this._widget.position||!this._model)return;const e=this._model.find(this._editor.getModel().uri,this._widget.position);e?this._widget.updateMarker(e.marker):this._widget.showStale()}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((e=>{this._editorService.openCodeEditor({resource:e.resource,options:{pinned:!0,revealIfOpened:!0,selection:s.e.lift(e).collapseToStart()}},this._editor),this.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((()=>this._cleanUp()))),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new g.L(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(t,i){var n,o;return We(this,void 0,void 0,(function*(){if(this._editor.hasModel()){const r=this._getOrCreateModel(i?void 0:this._editor.getModel().uri);if(r.move(t,this._editor.getModel(),this._editor.getPosition()),!r.selected)return;if(r.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const s=yield this._editorService.openCodeEditor({resource:r.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:r.selected.marker}},this._editor);s&&(null===(n=e.get(s))||void 0===n||n.close(),null===(o=e.get(s))||void 0===o||o.nagivate(t,i))}else this._widget.showAtMarker(r.selected.marker,r.selected.index,r.selected.total)}}))}};He.ID="editor.contrib.markerController",He=Ae([Fe(1,ue),Fe(2,k.i6),Fe(3,te.$),Fe(4,M.TG)],He);class Ke extends r.R6{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}run(e,t){var i;return We(this,void 0,void 0,(function*(){t.hasModel()&&(null===(i=He.get(t))||void 0===i||i.nagivate(this._next,this._multiFile))}))}}class Ve extends Ke{constructor(){super(!0,!1,{id:Ve.ID,label:Ve.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:578,weight:100},menuOpts:{menuId:Me.TitleMenu,title:Ve.LABEL,icon:(0,_e.q5)("marker-navigation-next",ee.l.arrowDown,G.NC("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}Ve.ID="editor.action.marker.next",Ve.LABEL=G.NC("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class Ue extends Ke{constructor(){super(!1,!1,{id:Ue.ID,label:Ue.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:1602,weight:100},menuOpts:{menuId:Me.TitleMenu,title:Ue.LABEL,icon:(0,_e.q5)("marker-navigation-previous",ee.l.arrowUp,G.NC("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}Ue.ID="editor.action.marker.prev",Ue.LABEL=G.NC("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");class Be extends Ke{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:G.NC("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:66,weight:100},menuOpts:{menuId:pe.eH.MenubarGoMenu,title:G.NC({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class Ge extends Ke{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:G.NC("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:a.u.focus,primary:1090,weight:100},menuOpts:{menuId:pe.eH.MenubarGoMenu,title:G.NC({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}(0,r._K)(He.ID,He,4),(0,r.Qr)(Ve),(0,r.Qr)(Ue),(0,r.Qr)(Be),(0,r.Qr)(Ge);const ze=new k.uy("markersNavigationVisible",!1),$e=r._l.bindToContribution(He.get);(0,r.fK)(new $e({id:"closeMarkersNavigation",precondition:ze,handler:e=>e.close(),kbOpts:{weight:150,kbExpr:a.u.focus,primary:9,secondary:[1033]}}));var je=i(34679),Ze=i(16458),Qe=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},qe=function(e,t){return function(i,n){t(i,n,e)}};const Xe=c.$;class Je{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const Ye={type:1,filter:{include:Y.yN.QuickFix},triggerAction:Y.aQ.QuickFixHover};let et=class{constructor(e,t,i,n){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=n,this.hoverOrdinal=5,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,o=i.getLineMaxColumn(n),r=[];for(const a of t){const t=a.range.startLineNumber===n?a.range.startColumn:1,d=a.range.endLineNumber===n?a.range.endColumn:o,l=this._markerDecorationsService.getMarker(i.uri,a);if(!l)continue;const c=new s.e(e.range.startLineNumber,t,e.range.startLineNumber,d);r.push(new Je(this,c,l))}return r}renderHoverParts(e,t){if(!t.length)return o.JT.None;const i=new o.SL;t.forEach((t=>e.fragment.appendChild(this.renderMarkerHover(t,i))));const n=1===t.length?t[0]:t.sort(((e,t)=>se.ZL.compare(e.marker.severity,t.marker.severity)))[0];return this.renderMarkerStatusbar(e,n,i),i}renderMarkerHover(e,t){const i=Xe("div.hover-row"),n=c.R3(i,Xe("div.marker.hover-contents")),{source:o,message:r,code:s,relatedInformation:a}=e.marker;this._editor.applyFontInfo(n);const d=c.R3(n,Xe("span"));if(d.style.whiteSpace="pre-wrap",d.innerText=r,o||s)if(s&&"string"!==typeof s){const e=Xe("span");if(o){const t=c.R3(e,Xe("span"));t.innerText=o}const i=c.R3(e,Xe("a.code-link"));i.setAttribute("href",s.target.toString()),t.add(c.nm(i,"click",(e=>{this._openerService.open(s.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()})));const r=c.R3(i,Xe("span"));r.innerText=s.value;const a=c.R3(n,e);a.style.opacity="0.6",a.style.paddingLeft="6px"}else{const e=c.R3(n,Xe("span"));e.style.opacity="0.6",e.style.paddingLeft="6px",e.innerText=o&&s?`${o}(${s})`:o||`(${s})`}if((0,u.Of)(a))for(const{message:l,resource:h,startLineNumber:u,startColumn:g}of a){const e=c.R3(n,Xe("div"));e.style.marginTop="8px";const i=c.R3(e,Xe("a"));i.innerText=`${(0,Q.EZ)(h)}(${u}, ${g}): `,i.style.cursor="pointer",t.add(c.nm(i,"click",(e=>{e.stopPropagation(),e.preventDefault(),this._openerService&&this._openerService.open(h,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:u,startColumn:g}}}).catch(m.dL)})));const o=c.R3(e,Xe("span"));o.innerText=l,this._editor.applyFontInfo(o)}return i}renderMarkerStatusbar(e,t,i){if(t.marker.severity!==se.ZL.Error&&t.marker.severity!==se.ZL.Warning&&t.marker.severity!==se.ZL.Info||e.statusBar.addAction({label:G.NC("view problem","View Problem"),commandId:Ve.ID,run:()=>{var i;e.hide(),null===(i=He.get(this._editor))||void 0===i||i.showAtMarker(t.marker),this._editor.focus()}}),!this._editor.getOption(86)){const n=e.statusBar.append(Xe("div"));this.recentMarkerCodeActionsInfo&&(se.H0.makeKey(this.recentMarkerCodeActionsInfo.marker)===se.H0.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(n.textContent=G.NC("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const r=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?o.JT.None:i.add((0,f.Vg)((()=>n.textContent=G.NC("checkingForQuickFixes","Checking for quick fixes...")),200));n.textContent||(n.textContent=String.fromCharCode(160));const s=this.getCodeActions(t.marker);i.add((0,o.OF)((()=>s.cancel()))),s.then((s=>{if(r.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:s.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions)return s.dispose(),void(n.textContent=G.NC("noQuickFixes","No quick fixes available"));n.style.display="none";let a=!1;i.add((0,o.OF)((()=>{a||s.dispose()}))),e.statusBar.addAction({label:G.NC("quick fixes","Quick Fix..."),commandId:J.E7.Id,run:t=>{a=!0;const i=J.G6.get(this._editor),n=c.i(t);e.hide(),null===i||void 0===i||i.showCodeActions(Ye,s,{x:n.left+6,y:n.top+n.height+6,width:n.width,height:n.height})}})}),m.dL)}}getCodeActions(e){return(0,f.PG)((t=>(0,X.aI)(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new s.e(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),Ye,je.Ex.None,t)))}};et=Qe([qe(1,q.i),qe(2,z.v4),qe(3,Ze.p)],et);var tt=i(35465),it=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},nt=function(e,t){return function(i,n){t(i,n,e)}};let ot=class e{static get(t){return t.getContribution(e.ID)}constructor(e,t,i,n,r){this._editor=e,this._instantiationService=t,this._openerService=i,this._languageService=n,this._toUnhook=new o.SL,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._hookEvents(),this._didChangeConfigurationHandler=this._editor.onDidChangeConfiguration((e=>{e.hasChanged(57)&&(this._unhookEvents(),this._hookEvents())}))}_hookEvents(){const e=()=>this._hideWidgets(),t=this._editor.getOption(57);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._toUnhook.add(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))):(this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))),this._toUnhook.add(this._editor.onMouseLeave((e=>this._onEditorMouseLeave(e)))),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange((e=>this._onEditorScrollChanged(e))))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._isMouseDown=!0;const t=e.target;9!==t.type||t.detail!==O.ID?12===t.type&&t.detail===U.ID||(12!==t.type&&(this._hoverClicked=!1),this._hideWidgets()):this._hoverClicked=!0}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseLeave(e){var t;const i=e.event.browserEvent.relatedTarget;(null===(t=this._contentWidget)||void 0===t?void 0:t.containsNode(i))||this._hideWidgets()}_onEditorMouseMove(e){var t,i,n,o,r,s;const a=e.target;if(this._isMouseDown&&this._hoverClicked)return;if(this._isHoverSticky&&9===a.type&&a.detail===O.ID)return;if(this._isHoverSticky&&!(null===(i=null===(t=e.event.browserEvent.view)||void 0===t?void 0:t.getSelection())||void 0===i?void 0:i.isCollapsed))return;if(!this._isHoverSticky&&9===a.type&&a.detail===O.ID&&(null===(n=this._contentWidget)||void 0===n?void 0:n.isColorPickerVisible()))return;if(this._isHoverSticky&&12===a.type&&a.detail===U.ID)return;if(this._isHoverSticky&&(null===(o=this._contentWidget)||void 0===o?void 0:o.isVisibleFromKeyboard()))return;if(!this._isHoverEnabled)return void this._hideWidgets();const d=this._getOrCreateContentWidget();if(!d.maybeShowAt(e))return 2===a.type&&a.position?(null===(s=this._contentWidget)||void 0===s||s.hide(),this._glyphWidget||(this._glyphWidget=new U(this._editor,this._languageService,this._openerService)),void this._glyphWidget.startShowingAt(a.position.lineNumber)):void this._hideWidgets();null===(r=this._glyphWidget)||void 0===r||r.hide()}_onKeyDown(e){5!==e.keyCode&&6!==e.keyCode&&57!==e.keyCode&&4!==e.keyCode&&this._hideWidgets()}_hideWidgets(){var e,t,i;this._isMouseDown&&this._hoverClicked&&(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible())||tt.Q.dropDownVisible||(this._hoverClicked=!1,null===(t=this._glyphWidget)||void 0===t||t.hide(),null===(i=this._contentWidget)||void 0===i||i.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(x,this._editor)),this._contentWidget}isColorPickerVisible(){var e;return(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible())||!1}showContentHover(e,t,i,n){this._getOrCreateContentWidget().startShowingAtRange(e,t,i,n)}dispose(){var e,t;this._unhookEvents(),this._toUnhook.dispose(),this._didChangeConfigurationHandler.dispose(),null===(e=this._glyphWidget)||void 0===e||e.dispose(),null===(t=this._contentWidget)||void 0===t||t.dispose()}};ot.ID="editor.contrib.hover",ot=it([nt(1,M.TG),nt(2,z.v4),nt(3,d.O),nt(4,k.i6)],ot);class rt extends r.R6{constructor(){super({id:"editor.action.showHover",label:G.NC({key:"showHover",comment:["Label for action that will trigger the showing of a hover in the editor.","This allows for users to show the hover without using the mouse."]},"Show Hover"),alias:"Show Hover",precondition:void 0,kbOpts:{kbExpr:a.u.editorTextFocus,primary:(0,n.gx)(2089,2087),weight:100}})}run(e,t){if(!t.hasModel())return;const i=ot.get(t);if(!i)return;const n=t.getPosition(),o=new s.e(n.lineNumber,n.column,n.lineNumber,n.column),r=2===t.getOption(2);i.showContentHover(o,1,1,r)}}class st extends r.R6{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:G.NC({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){const i=ot.get(t);if(!i)return;const n=t.getPosition();if(!n)return;const o=new s.e(n.lineNumber,n.column,n.lineNumber,n.column),r=l.GotoDefinitionAtPositionEditorContribution.get(t);if(!r)return;const a=r.startFindDefinitionFromCursor(n);a.then((()=>{i.showContentHover(o,1,1,!0)}))}}(0,r._K)(ot.ID,ot,2),(0,r.Qr)(rt),(0,r.Qr)(st),S.Ae.register(Z.D5),S.Ae.register(et),(0,j.Ic)(((e,t)=>{const i=e.getColor($.CNo);i&&(t.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${i.transparent(.5)}; }`))}))},97791:(e,t,i)=>{i.d(t,{Ae:()=>r,Qj:()=>n,YM:()=>o});class n{constructor(e,t,i,n){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=n,this.type=1}equals(e){return 1===e.type&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return 1===e.type&&t.lineNumber===this.range.startLineNumber}}class o{constructor(e,t,i,n,o,r){this.priority=e,this.owner=t,this.range=i,this.initialMousePosX=n,this.initialMousePosY=o,this.supportsMarkerHover=r,this.type=2}equals(e){return 2===e.type&&this.owner===e.owner}canAdoptVisibleHover(e,t){return 2===e.type&&this.owner===e.owner}}const r=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}}},25903:(e,t,i)=>{i.d(t,{D5:()=>b,c:()=>w,hU:()=>y});var n=i(2548),o=i(21921),r=i(85398),s=i(81478),a=i(70959),d=i(92767),l=i(89999),c=i(33162),h=i(61141),u=i(48864),g=i(25206),p=i(47596),_=i(6544),f=i(16458),m=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},v=function(e,t){return function(i,n){t(i,n,e)}};const C=n.$;class y{constructor(e,t,i,n,o){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=n,this.ordinal=o}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let b=class{constructor(e,t,i,n,o){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=n,this._languageFeaturesService=o,this.hoverOrdinal=2}createLoadingMessage(e){return new y(this,e.range,[(new s.W5).appendText(g.NC("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,r=i.getLineMaxColumn(n),a=[];let d=1e3;const l=i.getLineLength(n),h=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),u=this._editor.getOption(111),p=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:h});let _=!1;u>=0&&l>u&&e.range.startColumn>=u&&(_=!0,a.push(new y(this,e.range,[{value:g.NC("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,d++))),!_&&"number"===typeof p&&l>=p&&a.push(new y(this,e.range,[{value:g.NC("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,d++));let f=!1;for(const g of t){const t=g.range.startLineNumber===n?g.range.startColumn:1,i=g.range.endLineNumber===n?g.range.endColumn:r,l=g.options.hoverMessage;if(!l||(0,s.CP)(l))continue;g.options.beforeContentClassName&&(f=!0);const h=new c.e(e.range.startLineNumber,t,e.range.startLineNumber,i);a.push(new y(this,h,(0,o._2)(l),f,d++))}return a}computeAsync(e,t,i){if(!this._editor.hasModel()||1!==e.type)return r.Aq.EMPTY;const n=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(n))return r.Aq.EMPTY;const o=new l.L(e.range.startLineNumber,e.range.startColumn);return(0,u.R8)(this._languageFeaturesService.hoverProvider,n,o,i).filter((e=>!(0,s.CP)(e.hover.contents))).map((t=>{const i=t.hover.range?c.e.lift(t.hover.range):e.range;return new y(this,i,t.hover.contents,!1,t.ordinal)}))}renderHoverParts(e,t){return w(e,t,this._editor,this._languageService,this._openerService)}};function w(e,t,i,o,r){t.sort(((e,t)=>e.ordinal-t.ordinal));const l=new a.SL;for(const a of t)for(const t of a.contents){if((0,s.CP)(t))continue;const a=C("div.hover-row.markdown-hover"),c=n.R3(a,C("div.hover-contents")),h=l.add(new d.$({editor:i},o,r));l.add(h.onDidRenderAsync((()=>{c.className="hover-contents code-hover-contents",e.onContentsChanged()})));const u=l.add(h.render(t));c.appendChild(u.element),e.fragment.appendChild(a)}return l}b=m([v(1,h.O),v(2,_.v4),v(3,p.Ui),v(4,f.p)],b)},28649:(e,t,i)=>{function n(e,t){let i=0;for(let n=0;n<e.length;n++)"\t"===e.charAt(n)?i+=t:i++;return i}function o(e,t,i){e=e<0?0:e;let n="";if(!i){const i=Math.floor(e/t);e%=t;for(let e=0;e<i;e++)n+="\t"}for(let o=0;o<e;o++)n+=" ";return n}i.d(t,{J:()=>o,Y:()=>n})},92954:(e,t,i)=>{i.r(t),i.d(t,{AutoIndentOnPaste:()=>x,AutoIndentOnPasteCommand:()=>I,ChangeIndentationSizeAction:()=>S,ChangeTabDisplaySize:()=>D,DetectIndentation:()=>P,IndentUsingSpaces:()=>M,IndentUsingTabs:()=>k,IndentationToSpacesAction:()=>b,IndentationToSpacesCommand:()=>T,IndentationToTabsAction:()=>w,IndentationToTabsCommand:()=>E,ReindentLinesAction:()=>N,ReindentSelectedLinesAction:()=>R,getReindentEditOperations:()=>y});var n=i(70959),o=i(61720),r=i(48077),s=i(85175),a=i(90970),d=i(33162),l=i(54644),c=i(44950),h=i(97297),u=i(74016),g=i(28649),p=i(25206),_=i(45726),f=i(65006),m=i(52185),v=function(e,t,i,n){var o,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,i,s):o(t,i))||s);return r>3&&s&&Object.defineProperty(t,i,s),s},C=function(e,t){return function(i,n){t(i,n,e)}};function y(e,t,i,n,r){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return[];const d=t.getLanguageConfiguration(e.getLanguageId()).indentationRules;if(!d)return[];n=Math.min(n,e.getLineCount());while(i<=n){if(!d.unIndentedLinePattern)break;const t=e.getLineContent(i);if(!d.unIndentedLinePattern.test(t))break;i++}if(i>n-1)return[];const{tabSize:c,indentSize:h,insertSpaces:u}=e.getOptions(),g=(e,t)=>(t=t||1,s.U.shiftIndent(e,e.length+t,c,h,u)),p=(e,t)=>(t=t||1,s.U.unshiftIndent(e,e.length+t,c,h,u)),_=[];let m;const v=e.getLineContent(i);let C=v;if(void 0!==r&&null!==r){m=r;const e=o.V8(v);C=m+v.substring(e.length),d.decreaseIndentPattern&&d.decreaseIndentPattern.test(C)&&(m=p(m),C=m+v.substring(e.length)),v!==C&&_.push(a.h.replaceMove(new l.Y(i,1,i,e.length+1),(0,f.x)(m,h,u)))}else m=o.V8(v);let y=m;d.increaseIndentPattern&&d.increaseIndentPattern.test(C)?(y=g(y),m=g(m)):d.indentNextLinePattern&&d.indentNextLinePattern.test(C)&&(y=g(y)),i++;for(let s=i;s<=n;s++){const t=e.getLineContent(s),i=o.V8(t),n=y+t.substring(i.length);d.decreaseIndentPattern&&d.decreaseIndentPattern.test(n)&&(y=p(y),m=p(m)),i!==y&&_.push(a.h.replaceMove(new l.Y(s,1,s,i.length+1),(0,f.x)(y,h,u))),d.unIndentedLinePattern&&d.unIndentedLinePattern.test(t)||(d.increaseIndentPattern&&d.increaseIndentPattern.test(n)?(m=g(m),y=m):y=d.indentNextLinePattern&&d.indentNextLinePattern.test(n)?g(y):m)}return _}class b extends r.R6{constructor(){super({id:b.ID,label:p.NC("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:c.u.writable})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new T(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}}b.ID="editor.action.indentationToSpaces";class w extends r.R6{constructor(){super({id:w.ID,label:p.NC("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:c.u.writable})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const r=new E(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}}w.ID="editor.action.indentationToTabs";class S extends r.R6{constructor(e,t,i){super(i),this.insertSpaces=e,this.displaySizeOnly=t}run(e,t){const i=e.get(_.eJ),n=e.get(u.q),o=t.getModel();if(!o)return;const r=n.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget),s=o.getOptions(),a=[1,2,3,4,5,6,7,8].map((e=>({id:e.toString(),label:e.toString(),description:e===r.tabSize&&e===s.tabSize?p.NC("configuredTabSize","Configured Tab Size"):e===r.tabSize?p.NC("defaultTabSize","Default Tab Size"):e===s.tabSize?p.NC("currentTabSize","Current Tab Size"):void 0}))),d=Math.min(o.getOptions().tabSize-1,7);setTimeout((()=>{i.pick(a,{placeHolder:p.NC({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:a[d]}).then((e=>{if(e&&o&&!o.isDisposed()){const t=parseInt(e.label,10);this.displaySizeOnly?o.updateOptions({tabSize:t}):o.updateOptions({tabSize:t,indentSize:t,insertSpaces:this.insertSpaces})}}))}),50)}}class k extends S{constructor(){super(!1,!1,{id:k.ID,label:p.NC("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0})}}k.ID="editor.action.indentUsingTabs";class M extends S{constructor(){super(!0,!1,{id:M.ID,label:p.NC("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0})}}M.ID="editor.action.indentUsingSpaces";class D extends S{constructor(){super(!0,!0,{id:D.ID,label:p.NC("changeTabDisplaySize","Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0})}}D.ID="editor.action.changeTabDisplaySize";class P extends r.R6{constructor(){super({id:P.ID,label:p.NC("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0})}run(e,t){const i=e.get(u.q),n=t.getModel();if(!n)return;const o=i.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget);n.detectIndentation(o.insertSpaces,o.tabSize)}}P.ID="editor.action.detectIndentation";class N extends r.R6{constructor(){super({id:"editor.action.reindentlines",label:p.NC("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:c.u.writable})}run(e,t){const i=e.get(h.c_),n=t.getModel();if(!n)return;const o=y(n,i,1,n.getLineCount());o.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop())}}class R extends r.R6{constructor(){super({id:"editor.action.reindentselectedlines",label:p.NC("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:c.u.writable})}run(e,t){const i=e.get(h.c_),n=t.getModel();if(!n)return;const o=t.getSelections();if(null===o)return;const r=[];for(const s of o){let e=s.startLineNumber,t=s.endLineNumber;if(e!==t&&1===s.endColumn&&t--,1===e){if(e===t)continue}else e--;const o=y(n,i,e,t);r.push(...o)}r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}}class I{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(const i of e)i.range&&"string"===typeof i.text&&this._edits.push(i)}getEditOperations(e,t){for(const n of this._edits)t.addEditOperation(d.e.lift(n.range),n.text);let i=!1;Array.isArray(this._edits)&&1===this._edits.length&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}let x=class{constructor(e,t){this.editor=e,this._languageConfigurationService=t,this.callOnDispose=new n.SL,this.callOnModel=new n.SL,this.callOnDispose.add(e.onDidChangeConfiguration((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModel((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModelLanguage((()=>this.update())))}update(){this.callOnModel.clear(),this.editor.getOption(9)<4||this.editor.getOption(52)||this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste((({range:e})=>{this.trigger(e)})))}trigger(e){const t=this.editor.getSelections();if(null===t||t.length>1)return;const i=this.editor.getModel();if(!i)return;if(!i.tokenization.isCheapToTokenize(e.getStartPosition().lineNumber))return;const n=this.editor.getOption(9),{tabSize:r,indentSize:a,insertSpaces:l}=i.getOptions(),c=[],h={shiftIndent:e=>s.U.shiftIndent(e,e.length+1,r,a,l),unshiftIndent:e=>s.U.unshiftIndent(e,e.length+1,r,a,l)};let u=e.startLineNumber;while(u<=e.endLineNumber){if(!this.shouldIgnoreLine(i,u))break;u++}if(u>e.endLineNumber)return;let p=i.getLineContent(u);if(!/\S/.test(p.substring(0,e.startColumn-1))){const e=(0,m.n8)(n,i,i.getLanguageId(),u,h,this._languageConfigurationService);if(null!==e){const t=o.V8(p),n=g.Y(e,r),s=g.Y(t,r);if(n!==s){const e=g.J(n,r,l);c.push({range:new d.e(u,1,u,t.length+1),text:e}),p=e+p.substr(t.length)}else{const e=(0,m.tI)(i,u,this._languageConfigurationService);if(0===e||8===e)return}}}const _=u;while(u<e.endLineNumber){if(/\S/.test(i.getLineContent(u+1)))break;u++}if(u!==e.endLineNumber){const t={tokenization:{getLineTokens:e=>i.tokenization.getLineTokens(e),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(e,t)=>i.getLanguageIdAtPosition(e,t)},getLineContent:e=>e===_?p:i.getLineContent(e)},s=(0,m.n8)(n,t,i.getLanguageId(),u+1,h,this._languageConfigurationService);if(null!==s){const t=g.Y(s,r),n=g.Y(o.V8(i.getLineContent(u+1)),r);if(t!==n){const s=t-n;for(let t=u+1;t<=e.endLineNumber;t++){const e=i.getLineContent(t),n=o.V8(e),a=g.Y(n,r),h=a+s,u=g.J(h,r,l);u!==n&&c.push({range:new d.e(t,1,t,n.length+1),text:u})}}}}if(c.length>0){this.editor.pushUndoStop();const e=new I(c,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",e),this.editor.pushUndoStop()}}shouldIgnoreLine(e,t){e.tokenization.forceTokenization(t);const i=e.getLineFirstNonWhitespaceColumn(t);if(0===i)return!0;const n=e.tokenization.getLineTokens(t);if(n.getCount()>0){const e=n.findTokenIndexAtOffset(i);if(e>=0&&1===n.getStandardTokenType(e))return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}};function L(e,t,i,n){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return;let o="";for(let s=0;s<i;s++)o+=" ";const r=new RegExp(o,"gi");for(let s=1,a=e.getLineCount();s<=a;s++){let i=e.getLineFirstNonWhitespaceColumn(s);if(0===i&&(i=e.getLineMaxColumn(s)),1===i)continue;const a=new d.e(s,1,s,i),l=e.getValueInRange(a),c=n?l.replace(/\t/gi,o):l.replace(r,"\t");t.addEditOperation(a,c)}}x.ID="editor.contrib.autoIndentOnPaste",x=v([C(1,h.c_)],x);class T{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),L(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class E{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),L(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}(0,r._K)(x.ID,x,2),(0,r.Qr)(b),(0,r.Qr)(w),(0,r.Qr)(k),(0,r.Qr)(M),(0,r.Qr)(D),(0,r.Qr)(P),(0,r.Qr)(N),(0,r.Qr)(R)}}]);